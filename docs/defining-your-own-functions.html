<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Defining your own functions | Modern R with the tidyverse</title>
  <meta name="description" content="This book will teach you how to use R to solve your statistical, data science and machine learning problems. Importing data, computing descriptive statistics, running regressions (or more complex machine learning models) and generating reports are some of the topics covered. No previous experience with R is needed." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Defining your own functions | Modern R with the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book will teach you how to use R to solve your statistical, data science and machine learning problems. Importing data, computing descriptive statistics, running regressions (or more complex machine learning models) and generating reports are some of the topics covered. No previous experience with R is needed." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Defining your own functions | Modern R with the tidyverse" />
  
  <meta name="twitter:description" content="This book will teach you how to use R to solve your statistical, data science and machine learning problems. Importing data, computing descriptive statistics, running regressions (or more complex machine learning models) and generating reports are some of the topics covered. No previous experience with R is needed." />
  

<meta name="author" content="Bruno Rodrigues" />


<meta name="date" content="2022-10-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-models.html"/>
<link rel="next" href="functional-programming.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modern R with the tidyverse</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#note-to-the-reader"><i class="fa fa-check"></i>Note to the reader</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-r"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i>Who is this book for?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-modern-r"><i class="fa fa-check"></i>Why <em>modern</em> R?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-rstudio"><i class="fa fa-check"></i>What is RStudio?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-to-expect-from-this-book"><i class="fa fa-check"></i>What to expect from this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-are-packages"><i class="fa fa-check"></i>What are packages?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-author"><i class="fa fa-check"></i>The author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting to know RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#panes"><i class="fa fa-check"></i><b>1.1</b> Panes</a></li>
<li class="chapter" data-level="1.2" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#console"><i class="fa fa-check"></i><b>1.2</b> Console</a></li>
<li class="chapter" data-level="1.3" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#scripts"><i class="fa fa-check"></i><b>1.3</b> Scripts</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#the-help-pane"><i class="fa fa-check"></i><b>1.3.1</b> The help pane</a></li>
<li class="chapter" data-level="1.3.2" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#the-environment-pane"><i class="fa fa-check"></i><b>1.3.2</b> The Environment pane</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#options"><i class="fa fa-check"></i><b>1.4</b> Options</a></li>
<li class="chapter" data-level="1.5" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>1.5</b> Keyboard shortcuts</a></li>
<li class="chapter" data-level="1.6" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#projects"><i class="fa fa-check"></i><b>1.6</b> Projects</a></li>
<li class="chapter" data-level="1.7" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#history"><i class="fa fa-check"></i><b>1.7</b> History</a></li>
<li class="chapter" data-level="1.8" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#plots"><i class="fa fa-check"></i><b>1.8</b> Plots</a></li>
<li class="chapter" data-level="1.9" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#addins"><i class="fa fa-check"></i><b>1.9</b> Addins</a></li>
<li class="chapter" data-level="1.10" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#packages"><i class="fa fa-check"></i><b>1.10</b> Packages</a></li>
<li class="chapter" data-level="1.11" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#exercises"><i class="fa fa-check"></i><b>1.11</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><i class="fa fa-check"></i><b>2</b> Objects, their classes and types, and useful R functions to get you started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-numeric-class"><i class="fa fa-check"></i><b>2.1</b> The <code>numeric</code> class</a></li>
<li class="chapter" data-level="2.2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-character-class"><i class="fa fa-check"></i><b>2.2</b> The <code>character</code> class</a></li>
<li class="chapter" data-level="2.3" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-factor-class"><i class="fa fa-check"></i><b>2.3</b> The <code>factor</code> class</a></li>
<li class="chapter" data-level="2.4" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-date-class"><i class="fa fa-check"></i><b>2.4</b> The <code>Date</code> class</a></li>
<li class="chapter" data-level="2.5" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-logical-class"><i class="fa fa-check"></i><b>2.5</b> The <code>logical</code> class</a></li>
<li class="chapter" data-level="2.6" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#vectors-and-matrices"><i class="fa fa-check"></i><b>2.6</b> Vectors and matrices</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-c-function"><i class="fa fa-check"></i><b>2.6.1</b> The <code>c()</code> function</a></li>
<li class="chapter" data-level="2.6.2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#cbind-and-rbind"><i class="fa fa-check"></i><b>2.6.2</b> <code>cbind()</code> and <code>rbind()</code></a></li>
<li class="chapter" data-level="2.6.3" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-matrix-class"><i class="fa fa-check"></i><b>2.6.3</b> The <code>matrix</code> class</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-list-class"><i class="fa fa-check"></i><b>2.7</b> The <code>list</code> class</a></li>
<li class="chapter" data-level="2.8" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-data.frame-and-tibble-classes"><i class="fa fa-check"></i><b>2.8</b> The <code>data.frame</code> and <code>tibble</code> classes</a></li>
<li class="chapter" data-level="2.9" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#formulas"><i class="fa fa-check"></i><b>2.9</b> Formulas</a></li>
<li class="chapter" data-level="2.10" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#models"><i class="fa fa-check"></i><b>2.10</b> Models</a></li>
<li class="chapter" data-level="2.11" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#null-na-and-nan"><i class="fa fa-check"></i><b>2.11</b> NULL, NA and NaN</a></li>
<li class="chapter" data-level="2.12" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#useful-functions-to-get-you-started"><i class="fa fa-check"></i><b>2.12</b> Useful functions to get you started</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#sequences"><i class="fa fa-check"></i><b>2.12.1</b> Sequences</a></li>
<li class="chapter" data-level="2.12.2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#basic-string-manipulation"><i class="fa fa-check"></i><b>2.12.2</b> Basic string manipulation</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercises-1"><i class="fa fa-check"></i><b>2.13</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-6"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-7"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-8"><i class="fa fa-check"></i>Exercise 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>3</b> Reading and writing data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#the-swiss-army-knife-of-data-import-and-export-rio"><i class="fa fa-check"></i><b>3.1</b> The swiss army knife of data import and export: <code>{rio}</code></a></li>
<li class="chapter" data-level="3.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-any-object-to-disk"><i class="fa fa-check"></i><b>3.2</b> Writing any object to disk</a></li>
<li class="chapter" data-level="3.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#using-rstudio-projects-to-manage-paths"><i class="fa fa-check"></i><b>3.3</b> Using RStudio projects to manage paths</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Descriptive statistics and data manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#a-data-exploration-exercice-using-base-r"><i class="fa fa-check"></i><b>4.1</b> A data exploration exercice using <em>base</em> R</a></li>
<li class="chapter" data-level="4.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#smoking-is-bad-for-you-but-pipes-are-your-friend"><i class="fa fa-check"></i><b>4.2</b> Smoking is bad for you, but pipes are your friend</a></li>
<li class="chapter" data-level="4.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#the-tidyverses-enfant-prodige-dplyr"><i class="fa fa-check"></i><b>4.3</b> The <code>{tidyverse}</code>’s <em>enfant prodige</em>: <code>{dplyr}</code></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#a-first-taste-of-data-manipulation-with-dplyr"><i class="fa fa-check"></i><b>4.3.1</b> A first taste of data manipulation with <code>{dplyr}</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#filter-the-rows-of-a-dataset-with-filter"><i class="fa fa-check"></i><b>4.3.2</b> Filter the rows of a dataset with <code>filter()</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#select-columns-with-select"><i class="fa fa-check"></i><b>4.3.3</b> Select columns with <code>select()</code></a></li>
<li class="chapter" data-level="4.3.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#group-the-observations-of-your-dataset-with-group_by"><i class="fa fa-check"></i><b>4.3.4</b> Group the observations of your dataset with <code>group_by()</code></a></li>
<li class="chapter" data-level="4.3.5" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#get-summary-statistics-with-summarise"><i class="fa fa-check"></i><b>4.3.5</b> Get summary statistics with <code>summarise()</code></a></li>
<li class="chapter" data-level="4.3.6" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#adding-columns-with-mutate-and-transmute"><i class="fa fa-check"></i><b>4.3.6</b> Adding columns with <code>mutate()</code> and <code>transmute()</code></a></li>
<li class="chapter" data-level="4.3.7" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#joining-tibbles-with-full_join-left_join-right_join-and-all-the-others"><i class="fa fa-check"></i><b>4.3.7</b> Joining <code>tibble</code>s with <code>full_join()</code>, <code>left_join()</code>, <code>right_join()</code> and all the others</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#reshaping-and-sprucing-up-data-with-tidyr"><i class="fa fa-check"></i><b>4.4</b> Reshaping and sprucing up data with <code>{tidyr}</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#pivot_wider-and-pivot_longer"><i class="fa fa-check"></i><b>4.4.1</b> <code>pivot_wider()</code> and <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#fill-and-full_seq"><i class="fa fa-check"></i><b>4.4.2</b> <code>fill()</code> and <code>full_seq()</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#put-order-in-your-columns-with-separate-unite-and-in-your-rows-with-separate_rows"><i class="fa fa-check"></i><b>4.4.3</b> Put order in your columns with <code>separate()</code>, <code>unite()</code>, and in your rows with <code>separate_rows()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#working-on-many-columns-with-if_any-if_all-and-across"><i class="fa fa-check"></i><b>4.5</b> Working on many columns with <code>if_any()</code>, <code>if_all()</code> and <code>across()</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#filtering-rows-where-several-columns-verify-a-condition"><i class="fa fa-check"></i><b>4.5.1</b> Filtering rows where several columns verify a condition</a></li>
<li class="chapter" data-level="4.5.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#selecting-several-columns-at-once"><i class="fa fa-check"></i><b>4.5.2</b> Selecting several columns at once</a></li>
<li class="chapter" data-level="4.5.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#summarising-with-across"><i class="fa fa-check"></i><b>4.5.3</b> Summarising with <code>across()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#summarise-across-many-columns"><i class="fa fa-check"></i><b>4.5.4</b> <code>summarise()</code> across many columns</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#other-useful-tidyverse-functions"><i class="fa fa-check"></i><b>4.6</b> Other useful <code>{tidyverse}</code> functions</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#if_else-case_when-and-recode"><i class="fa fa-check"></i><b>4.6.1</b> <code>if_else()</code>, <code>case_when()</code> and <code>recode()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#lead-and-lag"><i class="fa fa-check"></i><b>4.6.2</b> <code>lead()</code> and <code>lag()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#ntile"><i class="fa fa-check"></i><b>4.6.3</b> <code>ntile()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#arrange"><i class="fa fa-check"></i><b>4.6.4</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#tally-and-count"><i class="fa fa-check"></i><b>4.6.5</b> <code>tally()</code> and <code>count()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#special-packages-for-special-kinds-of-data-forcats-lubridate-and-stringr"><i class="fa fa-check"></i><b>4.7</b> Special packages for special kinds of data: <code>{forcats}</code>, <code>{lubridate}</code>, and <code>{stringr}</code></a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#section"><i class="fa fa-check"></i><b>4.7.1</b> 🐱🐱🐱🐱</a></li>
<li class="chapter" data-level="4.7.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#get-your-dates-right-with-lubridate"><i class="fa fa-check"></i><b>4.7.2</b> Get your dates right with <code>{lubridate}</code></a></li>
<li class="chapter" data-level="4.7.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#manipulate-strings-with-stringr"><i class="fa fa-check"></i><b>4.7.3</b> Manipulate strings with <code>{stringr}</code></a></li>
<li class="chapter" data-level="4.7.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#tidy-data-frames-with-tibble"><i class="fa fa-check"></i><b>4.7.4</b> Tidy data frames with <code>{tibble}</code></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#list-columns"><i class="fa fa-check"></i><b>4.8</b> List-columns</a></li>
<li class="chapter" data-level="4.9" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#going-beyond-descriptive-statistics-and-data-manipulation"><i class="fa fa-check"></i><b>4.9</b> Going beyond descriptive statistics and data manipulation</a></li>
<li class="chapter" data-level="4.10" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#exercises-2"><i class="fa fa-check"></i><b>4.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>5</b> Graphs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="graphs.html"><a href="graphs.html#resources"><i class="fa fa-check"></i><b>5.1</b> Resources</a></li>
<li class="chapter" data-level="5.2" data-path="graphs.html"><a href="graphs.html#examples"><i class="fa fa-check"></i><b>5.2</b> Examples</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="graphs.html"><a href="graphs.html#barplots"><i class="fa fa-check"></i><b>5.2.1</b> Barplots</a></li>
<li class="chapter" data-level="5.2.2" data-path="graphs.html"><a href="graphs.html#scatter-plots"><i class="fa fa-check"></i><b>5.2.2</b> Scatter plots</a></li>
<li class="chapter" data-level="5.2.3" data-path="graphs.html"><a href="graphs.html#density"><i class="fa fa-check"></i><b>5.2.3</b> Density</a></li>
<li class="chapter" data-level="5.2.4" data-path="graphs.html"><a href="graphs.html#line-plots"><i class="fa fa-check"></i><b>5.2.4</b> Line plots</a></li>
<li class="chapter" data-level="5.2.5" data-path="graphs.html"><a href="graphs.html#facets"><i class="fa fa-check"></i><b>5.2.5</b> Facets</a></li>
<li class="chapter" data-level="5.2.6" data-path="graphs.html"><a href="graphs.html#pie-charts"><i class="fa fa-check"></i><b>5.2.6</b> Pie Charts</a></li>
<li class="chapter" data-level="5.2.7" data-path="graphs.html"><a href="graphs.html#adding-text-to-plots"><i class="fa fa-check"></i><b>5.2.7</b> Adding text to plots</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="graphs.html"><a href="graphs.html#customization"><i class="fa fa-check"></i><b>5.3</b> Customization</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="graphs.html"><a href="graphs.html#changing-titles-axes-labels-options-mixing-geoms-and-changing-themes"><i class="fa fa-check"></i><b>5.3.1</b> Changing titles, axes labels, options, mixing geoms and changing themes</a></li>
<li class="chapter" data-level="5.3.2" data-path="graphs.html"><a href="graphs.html#colour-schemes"><i class="fa fa-check"></i><b>5.3.2</b> Colour schemes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="graphs.html"><a href="graphs.html#saving-plots-to-disk"><i class="fa fa-check"></i><b>5.4</b> Saving plots to disk</a></li>
<li class="chapter" data-level="5.5" data-path="graphs.html"><a href="graphs.html#exercises-3"><i class="fa fa-check"></i><b>5.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="graphs.html"><a href="graphs.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-models.html"><a href="statistical-models.html"><i class="fa fa-check"></i><b>6</b> Statistical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-models.html"><a href="statistical-models.html#terminology"><i class="fa fa-check"></i><b>6.1</b> Terminology</a></li>
<li class="chapter" data-level="6.2" data-path="statistical-models.html"><a href="statistical-models.html#fitting-a-model-to-data"><i class="fa fa-check"></i><b>6.2</b> Fitting a model to data</a></li>
<li class="chapter" data-level="6.3" data-path="statistical-models.html"><a href="statistical-models.html#diagnostics"><i class="fa fa-check"></i><b>6.3</b> Diagnostics</a></li>
<li class="chapter" data-level="6.4" data-path="statistical-models.html"><a href="statistical-models.html#interpreting-models"><i class="fa fa-check"></i><b>6.4</b> Interpreting models</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="statistical-models.html"><a href="statistical-models.html#marginal-effects"><i class="fa fa-check"></i><b>6.4.1</b> Marginal effects</a></li>
<li class="chapter" data-level="6.4.2" data-path="statistical-models.html"><a href="statistical-models.html#explainability-of-black-box-models"><i class="fa fa-check"></i><b>6.4.2</b> Explainability of <em>black-box</em> models</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="statistical-models.html"><a href="statistical-models.html#comparing-models"><i class="fa fa-check"></i><b>6.5</b> Comparing models</a></li>
<li class="chapter" data-level="6.6" data-path="statistical-models.html"><a href="statistical-models.html#using-a-model-for-prediction"><i class="fa fa-check"></i><b>6.6</b> Using a model for prediction</a></li>
<li class="chapter" data-level="6.7" data-path="statistical-models.html"><a href="statistical-models.html#beyond-linear-regression"><i class="fa fa-check"></i><b>6.7</b> Beyond linear regression</a></li>
<li class="chapter" data-level="6.8" data-path="statistical-models.html"><a href="statistical-models.html#hyper-parameters"><i class="fa fa-check"></i><b>6.8</b> Hyper-parameters</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="statistical-models.html"><a href="statistical-models.html#ridge-regression"><i class="fa fa-check"></i><b>6.8.1</b> Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="statistical-models.html"><a href="statistical-models.html#training-validating-and-testing-models"><i class="fa fa-check"></i><b>6.9</b> Training, validating, and testing models</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="statistical-models.html"><a href="statistical-models.html#set-up"><i class="fa fa-check"></i><b>6.9.1</b> Set up</a></li>
<li class="chapter" data-level="6.9.2" data-path="statistical-models.html"><a href="statistical-models.html#bayesian-hyperparameter-optimization"><i class="fa fa-check"></i><b>6.9.2</b> Bayesian hyperparameter optimization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html"><i class="fa fa-check"></i><b>7</b> Defining your own functions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#control-flow"><i class="fa fa-check"></i><b>7.1</b> Control flow</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#if-else"><i class="fa fa-check"></i><b>7.1.1</b> If-else</a></li>
<li class="chapter" data-level="7.1.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#for-loops"><i class="fa fa-check"></i><b>7.1.2</b> For loops</a></li>
<li class="chapter" data-level="7.1.3" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#while-loops"><i class="fa fa-check"></i><b>7.1.3</b> While loops</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#writing-your-own-functions"><i class="fa fa-check"></i><b>7.2</b> Writing your own functions</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#declaring-functions-in-r"><i class="fa fa-check"></i><b>7.2.1</b> Declaring functions in R</a></li>
<li class="chapter" data-level="7.2.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#fibonacci-numbers"><i class="fa fa-check"></i><b>7.2.2</b> Fibonacci numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercises-4"><i class="fa fa-check"></i><b>7.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-take-functions-as-arguments-writing-your-own-higher-order-functions"><i class="fa fa-check"></i><b>7.4</b> Functions that take functions as arguments: writing your own higher-order functions</a></li>
<li class="chapter" data-level="7.5" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-return-functions"><i class="fa fa-check"></i><b>7.5</b> Functions that return functions</a></li>
<li class="chapter" data-level="7.6" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-take-columns-of-data-as-arguments"><i class="fa fa-check"></i><b>7.6</b> Functions that take columns of data as arguments</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#the-enquo---approach"><i class="fa fa-check"></i><b>7.6.1</b> The <code>enquo() - !!()</code> approach</a></li>
<li class="chapter" data-level="7.6.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#curly-curly-a-simplified-approach-to-enquo-and"><i class="fa fa-check"></i><b>7.6.2</b> Curly Curly, a simplified approach to <code>enquo()</code> and <code>!!()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-use-loops"><i class="fa fa-check"></i><b>7.7</b> Functions that use loops</a></li>
<li class="chapter" data-level="7.8" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#anonymous-functions"><i class="fa fa-check"></i><b>7.8</b> Anonymous functions</a></li>
<li class="chapter" data-level="7.9" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercises-5"><i class="fa fa-check"></i><b>7.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="functional-programming.html"><a href="functional-programming.html"><i class="fa fa-check"></i><b>8</b> Functional programming</a>
<ul>
<li class="chapter" data-level="8.1" data-path="functional-programming.html"><a href="functional-programming.html#function-definitions"><i class="fa fa-check"></i><b>8.1</b> Function definitions</a></li>
<li class="chapter" data-level="8.2" data-path="functional-programming.html"><a href="functional-programming.html#properties-of-functions"><i class="fa fa-check"></i><b>8.2</b> Properties of functions</a></li>
<li class="chapter" data-level="8.3" data-path="functional-programming.html"><a href="functional-programming.html#functional-programming-with-purrr"><i class="fa fa-check"></i><b>8.3</b> Functional programming with <code>{purrr}</code></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="functional-programming.html"><a href="functional-programming.html#doing-away-with-loops-the-map-family-of-functions"><i class="fa fa-check"></i><b>8.3.1</b> Doing away with loops: the <code>map*()</code> family of functions</a></li>
<li class="chapter" data-level="8.3.2" data-path="functional-programming.html"><a href="functional-programming.html#reducing-with-purrr"><i class="fa fa-check"></i><b>8.3.2</b> Reducing with <code>purrr</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="functional-programming.html"><a href="functional-programming.html#error-handling-with-safely-and-possibly"><i class="fa fa-check"></i><b>8.3.3</b> Error handling with <code>safely()</code> and <code>possibly()</code></a></li>
<li class="chapter" data-level="8.3.4" data-path="functional-programming.html"><a href="functional-programming.html#partial-applications-with-partial"><i class="fa fa-check"></i><b>8.3.4</b> Partial applications with <code>partial()</code></a></li>
<li class="chapter" data-level="8.3.5" data-path="functional-programming.html"><a href="functional-programming.html#function-composition-using-compose"><i class="fa fa-check"></i><b>8.3.5</b> Function composition using <code>compose</code></a></li>
<li class="chapter" data-level="8.3.6" data-path="functional-programming.html"><a href="functional-programming.html#transposing-lists"><i class="fa fa-check"></i><b>8.3.6</b> «Transposing lists»</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="functional-programming.html"><a href="functional-programming.html#list-based-workflows-for-efficiency"><i class="fa fa-check"></i><b>8.4</b> List-based workflows for efficiency</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="functional-programming.html"><a href="functional-programming.html#functional-programming-and-plotting"><i class="fa fa-check"></i><b>8.4.1</b> Functional programming and plotting</a></li>
<li class="chapter" data-level="8.4.2" data-path="functional-programming.html"><a href="functional-programming.html#modeling-with-functional-programming"><i class="fa fa-check"></i><b>8.4.2</b> Modeling with functional programming</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="functional-programming.html"><a href="functional-programming.html#exercises-6"><i class="fa fa-check"></i><b>8.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="functional-programming.html"><a href="functional-programming.html#exercise-1-6"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="functional-programming.html"><a href="functional-programming.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="package-development.html"><a href="package-development.html"><i class="fa fa-check"></i><b>9</b> Package development</a>
<ul>
<li class="chapter" data-level="9.1" data-path="package-development.html"><a href="package-development.html#why-you-need-to-write-your-own-package"><i class="fa fa-check"></i><b>9.1</b> Why you need to write your own package</a></li>
<li class="chapter" data-level="9.2" data-path="package-development.html"><a href="package-development.html#starting-easy-creating-a-package-to-share-data"><i class="fa fa-check"></i><b>9.2</b> Starting easy: creating a package to share data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="package-development.html"><a href="package-development.html#setting-up-a-github-account"><i class="fa fa-check"></i><b>9.2.1</b> Setting up a Github account</a></li>
<li class="chapter" data-level="9.2.2" data-path="package-development.html"><a href="package-development.html#starting-your-package"><i class="fa fa-check"></i><b>9.2.2</b> Starting your package</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="package-development.html"><a href="package-development.html#including-data-inside-the-package"><i class="fa fa-check"></i><b>9.3</b> Including data inside the package</a></li>
<li class="chapter" data-level="9.4" data-path="package-development.html"><a href="package-development.html#adding-functions-to-your-package"><i class="fa fa-check"></i><b>9.4</b> Adding functions to your package</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="package-development.html"><a href="package-development.html#one-function-inside-one-script"><i class="fa fa-check"></i><b>9.4.1</b> One function inside one script</a></li>
<li class="chapter" data-level="9.4.2" data-path="package-development.html"><a href="package-development.html#many-functions-inside-a-script"><i class="fa fa-check"></i><b>9.4.2</b> Many functions inside a script</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="package-development.html"><a href="package-development.html#documenting-your-package"><i class="fa fa-check"></i><b>9.5</b> Documenting your package</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="package-development.html"><a href="package-development.html#description"><i class="fa fa-check"></i><b>9.5.1</b> Description</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="package-development.html"><a href="package-development.html#unit-testing-your-package"><i class="fa fa-check"></i><b>9.6</b> Unit testing your package</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="further-topics.html"><a href="further-topics.html"><i class="fa fa-check"></i><b>10</b> Further topics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="further-topics.html"><a href="further-topics.html#using-python-from-r-with-reticulate"><i class="fa fa-check"></i><b>10.1</b> Using Python from R with <code>{reticulate}</code></a></li>
<li class="chapter" data-level="10.2" data-path="further-topics.html"><a href="further-topics.html#generating-pdf-or-word-reports-with-r"><i class="fa fa-check"></i><b>10.2</b> Generating Pdf or Word reports with R</a></li>
<li class="chapter" data-level="10.3" data-path="further-topics.html"><a href="further-topics.html#scraping-the-internet"><i class="fa fa-check"></i><b>10.3</b> Scraping the internet</a></li>
<li class="chapter" data-level="10.4" data-path="further-topics.html"><a href="further-topics.html#regular-expressions"><i class="fa fa-check"></i><b>10.4</b> Regular expressions</a></li>
<li class="chapter" data-level="10.5" data-path="further-topics.html"><a href="further-topics.html#setting-up-a-blog-with-blogdown"><i class="fa fa-check"></i><b>10.5</b> Setting up a blog with <code>{blogdown}</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern R with the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="defining-your-own-functions" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Defining your own functions<a href="defining-your-own-functions.html#defining-your-own-functions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section we are going to learn some advanced concepts that are going to make you into a
full-fledged R programmer. Before this chapter you only used whatever R came with, as well as the
functions contained in packages. We did define some functions ourselves in Chapter 6 already, but
without going into many details. In this chapter, we will learn about building functions ourselves,
and do so in greater detail than what we did before.</p>
<div id="control-flow" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Control flow<a href="defining-your-own-functions.html#control-flow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Knowing about control flow is essential to build your own functions. Without control flow statements,
such as if-else statements or loops (or, in the case of pure functional programming languages, recursion),
programming languages would be very limited.</p>
<div id="if-else" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> If-else<a href="defining-your-own-functions.html#if-else" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Imagine you want a variable to be equal to a certain value if a condition is met. This is a typical
problem that requires the <code>if ... else ...</code> construct. For instance:</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="defining-your-own-functions.html#cb906-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb906-2"><a href="defining-your-own-functions.html#cb906-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span></code></pre></div>
<p>Suppose that if <code>a &gt; b</code> then <code>f</code> should be equal to 20, else <code>f</code> should be equal to 10. Using <code>if ... else ...</code> you can achieve this like so:</p>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="defining-your-own-functions.html#cb907-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (a <span class="sc">&gt;</span> b) {</span>
<span id="cb907-2"><a href="defining-your-own-functions.html#cb907-2" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb907-3"><a href="defining-your-own-functions.html#cb907-3" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb907-4"><a href="defining-your-own-functions.html#cb907-4" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb907-5"><a href="defining-your-own-functions.html#cb907-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Obviously, here <code>f = 10</code>. Another way to achieve this is by using the <code>ifelse()</code> function:</p>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="defining-your-own-functions.html#cb908-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(a <span class="sc">&gt;</span> b, <span class="dv">20</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><code>if...else...</code> and <code>ifelse()</code> might seem interchangeable, but they’re not. <code>ifelse()</code> is vectorized, while
<code>if...else..</code> is not. Let’s try the following:</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="defining-your-own-functions.html#cb909-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>) <span class="sc">&gt;</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;no&quot;  &quot;yes&quot; &quot;yes&quot;</code></pre>
<p>The result is a vector. Now, let’s see what happens if we use <code>if...else...</code> instead of <code>ifelse()</code>:</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="defining-your-own-functions.html#cb911-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>) <span class="sc">&gt;</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="fu">print</span>(<span class="st">&quot;yes&quot;</span>) <span class="cf">else</span> <span class="fu">print</span>(<span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="defining-your-own-functions.html#cb912-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Error <span class="cf">in</span> <span class="cf">if</span> (<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>) <span class="sc">&gt;</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="fu">print</span>(<span class="st">&quot;yes&quot;</span>) <span class="cf">else</span> <span class="fu">print</span>(<span class="st">&quot;no&quot;</span>) <span class="sc">:</span> </span>
<span id="cb912-2"><a href="defining-your-own-functions.html#cb912-2" aria-hidden="true" tabindex="-1"></a>  the condition has length <span class="sc">&gt;</span> <span class="dv">1</span></span></code></pre></div>
<p>This results in an error (in previous R version, only the first element of the vector would get used).
We have already discussed this in Chapter 2, remember? If you want to make sure that such an expression
evaluates to <code>TRUE</code>, then you need to use <code>all()</code>:</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="defining-your-own-functions.html#cb913-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>) <span class="sc">&gt;</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="st">&quot;all elements are greater&quot;</span>, <span class="st">&quot;not all elements are greater&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;not all elements are greater&quot;</code></pre>
<p>You may also remember the <code>any()</code> function:</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="defining-your-own-functions.html#cb915-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>) <span class="sc">&gt;</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="st">&quot;at least one element is greater&quot;</span>, <span class="st">&quot;no element greater&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;at least one element is greater&quot;</code></pre>
<p>These are the basics. But sometimes, you might need to test for more complex conditions, which can
lead to using nested <code>if...else...</code> constructs. These, however, can get messy:</p>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="defining-your-own-functions.html#cb917-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">10</span> <span class="sc">%%</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb917-2"><a href="defining-your-own-functions.html#cb917-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;10 is divisible by 3&quot;</span>)</span>
<span id="cb917-3"><a href="defining-your-own-functions.html#cb917-3" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="dv">10</span> <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb917-4"><a href="defining-your-own-functions.html#cb917-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;10 is divisible by 2&quot;</span>)</span>
<span id="cb917-5"><a href="defining-your-own-functions.html#cb917-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;10 is divisible by 2&quot;</code></pre>
<p>10 being obviously divisible by 2 and not 3, it is the second sentence that will be printed. The
<code>%%</code> operator is the modulus operator, which gives the rest of the division of 10 by 2. In such
cases, it is easier to use <code>dplyr::case_when()</code>:</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="defining-your-own-functions.html#cb919-1" aria-hidden="true" tabindex="-1"></a><span class="fu">case_when</span>(<span class="dv">10</span> <span class="sc">%%</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;10 is divisible by 3&quot;</span>,</span>
<span id="cb919-2"><a href="defining-your-own-functions.html#cb919-2" aria-hidden="true" tabindex="-1"></a>          <span class="dv">10</span> <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;10 is divisible by 2&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;10 is divisible by 2&quot;</code></pre>
<p>We have already encountered this function in Chapter 4, inside a <code>dplyr::mutate()</code> call to create a new column.</p>
<p>Let’s now discuss loops.</p>
</div>
<div id="for-loops" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> For loops<a href="defining-your-own-functions.html#for-loops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For loops make it possible to repeat a set of instructions <code>i</code> times. For example, try the following:</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="defining-your-own-functions.html#cb921-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb921-2"><a href="defining-your-own-functions.html#cb921-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;hello&quot;</span>)</span>
<span id="cb921-3"><a href="defining-your-own-functions.html#cb921-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;
## [1] &quot;hello&quot;</code></pre>
<p>It is also possible to do computations using for loops. Let’s compute the sum of the first
100 integers:</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="defining-your-own-functions.html#cb923-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb923-2"><a href="defining-your-own-functions.html#cb923-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb923-3"><a href="defining-your-own-functions.html#cb923-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> result <span class="sc">+</span> i</span>
<span id="cb923-4"><a href="defining-your-own-functions.html#cb923-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb923-5"><a href="defining-your-own-functions.html#cb923-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb923-6"><a href="defining-your-own-functions.html#cb923-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] 5050</code></pre>
<p><code>result</code> is equal to 5050, the expected result. What happened in that loop? First, we defined a
variable called <code>result</code> and set it to 0. Then, when the loops starts, <code>i</code> equals 1, so we add
<code>result</code> to <code>1</code>, which is 1. Then, <code>i</code> equals 2, and again, we add <code>result</code> to <code>i</code>. But this time,
<code>result</code> equals 1 and <code>i</code> equals 2, so now <code>result</code> equals 3, and we repeat this until <code>i</code>
equals 100. If you know a programming language like C, this probably looks familiar. However, R is
not C, and you should, if possible, avoid writing code that looks like this. You should always
ask yourself the following questions:</p>
<ul>
<li>Is there an inbuilt function to achieve what I need? In this case we have <code>sum()</code>, so we could use <code>sum(seq(1, 100))</code>.</li>
<li>Is there a way to use matrix algebra? This can sometimes make things easier, but it depends how comfortable
you are with matrix algebra. This would be the solution with matrix algebra: <code>rep(1, 100) %*% seq(1, 100)</code>.</li>
<li>Is there a way to use building blocks that are already available? For instance, suppose that <code>sum()</code>
would not be a function available in R. Another way to solve this issue would be to use the following
building blocks: <code>+</code>, which computes the sum of two numbers and <code>Reduce()</code>, which <em>reduces</em> a list
of elements using an operator. Sounds complicated? Let’s see how <code>Reduce()</code> works. First, let me show you how
I combine these two functions to achieve the same result as when using <code>sum()</code>:</li>
</ul>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="defining-your-own-functions.html#cb925-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Reduce</span>(<span class="st">`</span><span class="at">+</span><span class="st">`</span>, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>))</span></code></pre></div>
<pre><code>## [1] 5050</code></pre>
<p>We will see how <code>Reduce()</code> works in greater detail in the next chapter, but what happened was something like this:</p>
<pre><code>Reduce(`+`, seq(1, 100)) = 
 1 + Reduce(`+`, seq(2, 100)) = 
 1 + 2 + Reduce(`+`, seq(3, 100)) = 
 1 + 2 + 3 + Reduce(`+`, seq(4, 100)) = 
 ....</code></pre>
<p>If you ask yourself these questions, it turns out that you only rarely actually need to write loops, but loops are
still important, because sometimes there simply isn’t an alternative. Also, there are other situations where loops
are also important, so I refer you to the following <a href="http://adv-r.had.co.nz/Functionals.html#functionals-not">section</a>
of Hadley Wickham’s <em>Advanced R</em> for an in-depth discussion on situations where loops make more
sense than using functions such as <code>Reduce()</code>.</p>
</div>
<div id="while-loops" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> While loops<a href="defining-your-own-functions.html#while-loops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While loops are very similar to for loops. The instructions inside a while loop are repeated while a
certain condition holds true. Let’s consider the sum of the first 100 integers again:</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="defining-your-own-functions.html#cb928-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb928-2"><a href="defining-your-own-functions.html#cb928-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb928-3"><a href="defining-your-own-functions.html#cb928-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i<span class="sc">&lt;=</span><span class="dv">100</span>){</span>
<span id="cb928-4"><a href="defining-your-own-functions.html#cb928-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">=</span> result <span class="sc">+</span> i</span>
<span id="cb928-5"><a href="defining-your-own-functions.html#cb928-5" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb928-6"><a href="defining-your-own-functions.html#cb928-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb928-7"><a href="defining-your-own-functions.html#cb928-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb928-8"><a href="defining-your-own-functions.html#cb928-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] 5050</code></pre>
<p>Here, we first set <code>result</code> and <code>i</code> to 0. Then, while <code>i</code> is less than, or equal to 100, we add <code>i</code>
to <code>result</code>. Notice that there is one more line than in the for loop version of this code: we need
to increment the value of <code>i</code> at each iteration, if not, <code>i</code> would stay equal to 1, and the
condition would always be fulfilled, and the loop would run forever (not really, only until your
computer runs out of memory, or until the heat death of the universe, whichever comes first).</p>
<p>Now that we know how to write loops, and know about <code>if...else...</code> constructs, we have (almost) all
the ingredients to write our own functions.</p>
</div>
</div>
<div id="writing-your-own-functions" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Writing your own functions<a href="defining-your-own-functions.html#writing-your-own-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As you have seen by now, R includes a very large amount of in-built functions, but also many
more functions are available in packages. However, there will be a lot of situations where you will
need to write your own. In this section we are going to learn how to write our own functions.</p>
<div id="declaring-functions-in-r" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Declaring functions in R<a href="defining-your-own-functions.html#declaring-functions-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose you want to create the following function: <span class="math inline">\(f(x) = \dfrac{1}{\sqrt{x}}\)</span>.
Writing this in R is quite simple:</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="defining-your-own-functions.html#cb930-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb930-2"><a href="defining-your-own-functions.html#cb930-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(x)</span>
<span id="cb930-3"><a href="defining-your-own-functions.html#cb930-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The argument of the function, <code>x</code>, gets passed to the <code>function()</code> function and the <em>body</em> of
the function (more on that in the next Chapter) contains the function definition. Of course,
you could define functions that use more than one input:</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="defining-your-own-functions.html#cb931-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb931-2"><a href="defining-your-own-functions.html#cb931-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(x <span class="sc">+</span> y)</span>
<span id="cb931-3"><a href="defining-your-own-functions.html#cb931-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>or inputs with names longer than one character:</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="defining-your-own-functions.html#cb932-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(argument1, argument2){</span>
<span id="cb932-2"><a href="defining-your-own-functions.html#cb932-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(argument1 <span class="sc">+</span> argument2)</span>
<span id="cb932-3"><a href="defining-your-own-functions.html#cb932-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Functions written by the user get called just the same way as functions included in R:</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="defining-your-own-functions.html#cb933-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 0.3015113</code></pre>
<p>It is also possible to provide default values to the function’s arguments, which are values that are used
if the user omits them:</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="defining-your-own-functions.html#cb935-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(argument1, <span class="at">argument2 =</span> <span class="dv">10</span>){</span>
<span id="cb935-2"><a href="defining-your-own-functions.html#cb935-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(argument1 <span class="sc">+</span> argument2)</span>
<span id="cb935-3"><a href="defining-your-own-functions.html#cb935-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="defining-your-own-functions.html#cb936-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.3015113</code></pre>
<p>This is especially useful for functions with many arguments. Consider also the following example,
where the function has a default method:</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="defining-your-own-functions.html#cb938-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(argument1, argument2, <span class="at">method =</span> <span class="st">&quot;foo&quot;</span>){</span>
<span id="cb938-2"><a href="defining-your-own-functions.html#cb938-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb938-3"><a href="defining-your-own-functions.html#cb938-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> argument1 <span class="sc">+</span> argument2</span>
<span id="cb938-4"><a href="defining-your-own-functions.html#cb938-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb938-5"><a href="defining-your-own-functions.html#cb938-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;foo&quot;</span>){</span>
<span id="cb938-6"><a href="defining-your-own-functions.html#cb938-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(x)</span>
<span id="cb938-7"><a href="defining-your-own-functions.html#cb938-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">&quot;bar&quot;</span>){</span>
<span id="cb938-8"><a href="defining-your-own-functions.html#cb938-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;this is a string&quot;</span></span>
<span id="cb938-9"><a href="defining-your-own-functions.html#cb938-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb938-10"><a href="defining-your-own-functions.html#cb938-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb938-11"><a href="defining-your-own-functions.html#cb938-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb938-12"><a href="defining-your-own-functions.html#cb938-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">10</span>, <span class="dv">11</span>)</span></code></pre></div>
<pre><code>## [1] 0.2182179</code></pre>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="defining-your-own-functions.html#cb940-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="st">&quot;bar&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;this is a string&quot;</code></pre>
<p>As you see, depending on the “method” chosen, the returned result is either a numeric, or a string.
What happens if the user provides a “method” that is neither “foo” nor “bar”?</p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="defining-your-own-functions.html#cb942-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="st">&quot;spam&quot;</span>)</span></code></pre></div>
<p>As you can see nothing happens. It is possible to add safeguards to your function to avoid such
situations:</p>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="defining-your-own-functions.html#cb943-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(argument1, argument2, <span class="at">method =</span> <span class="st">&quot;foo&quot;</span>){</span>
<span id="cb943-2"><a href="defining-your-own-functions.html#cb943-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb943-3"><a href="defining-your-own-functions.html#cb943-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>))){</span>
<span id="cb943-4"><a href="defining-your-own-functions.html#cb943-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;Method must be either &#39;foo&#39; or &#39;bar&#39;&quot;</span>)</span>
<span id="cb943-5"><a href="defining-your-own-functions.html#cb943-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb943-6"><a href="defining-your-own-functions.html#cb943-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb943-7"><a href="defining-your-own-functions.html#cb943-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> argument1 <span class="sc">+</span> argument2</span>
<span id="cb943-8"><a href="defining-your-own-functions.html#cb943-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb943-9"><a href="defining-your-own-functions.html#cb943-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;foo&quot;</span>){</span>
<span id="cb943-10"><a href="defining-your-own-functions.html#cb943-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(x)</span>
<span id="cb943-11"><a href="defining-your-own-functions.html#cb943-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">&quot;bar&quot;</span>){</span>
<span id="cb943-12"><a href="defining-your-own-functions.html#cb943-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;this is a string&quot;</span></span>
<span id="cb943-13"><a href="defining-your-own-functions.html#cb943-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb943-14"><a href="defining-your-own-functions.html#cb943-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb943-15"><a href="defining-your-own-functions.html#cb943-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb943-16"><a href="defining-your-own-functions.html#cb943-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">10</span>, <span class="dv">11</span>)</span></code></pre></div>
<pre><code>## [1] 0.2182179</code></pre>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="defining-your-own-functions.html#cb945-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="st">&quot;bar&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;this is a string&quot;</code></pre>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="defining-your-own-functions.html#cb947-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="st">&quot;foobar&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Method must be either &#39;foo&#39; or &#39;bar&#39;&quot;</code></pre>
<p>Notice that I have used <code>return()</code> inside my first <code>if</code> statement. This is to immediately stop
evaluation of the function and return a value. If I had omitted it, evaluation would have
continued, as it is always the last expression that gets evaluated. Remove <code>return()</code> and run the
function again, and see what happens. Later, we are going to learn how to add better safeguards to
your functions and to avoid runtime errors.</p>
<p>While in general, it is a good idea to add comments to your functions to explain what they do, I
would avoid adding comments to functions that do things that are very obvious, such as with this
one. Function names should be of the form: <code>function_name()</code>. Always give your function very
explicit names! In mathematics it is standard to give functions just one letter as a name, but I
would advise against doing that in your code. Functions that you write are not special in any way;
this means that R will treat them the same way, and they will work in conjunction with any other
function just as if it was built-in into R.</p>
<p>They have one limitation though (which is shared with R’s native function): just like in math,
they can only return one value. However, sometimes, you may need to return more than one value.
To be able to do this, you must put your values in a list, and return the list of values. For example:</p>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb949-1"><a href="defining-your-own-functions.html#cb949-1" aria-hidden="true" tabindex="-1"></a>average_and_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb949-2"><a href="defining-your-own-functions.html#cb949-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span>
<span id="cb949-3"><a href="defining-your-own-functions.html#cb949-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb949-4"><a href="defining-your-own-functions.html#cb949-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb949-5"><a href="defining-your-own-functions.html#cb949-5" aria-hidden="true" tabindex="-1"></a><span class="fu">average_and_sd</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## [1] 7.166667 4.262237</code></pre>
<p>You’re still returning a single object, but it’s a vector. You can also return a named list:</p>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="defining-your-own-functions.html#cb951-1" aria-hidden="true" tabindex="-1"></a>average_and_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb951-2"><a href="defining-your-own-functions.html#cb951-2" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="st">&quot;mean_x&quot;</span> <span class="ot">=</span>  <span class="fu">mean</span>(x), <span class="st">&quot;sd_x&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(x))</span>
<span id="cb951-3"><a href="defining-your-own-functions.html#cb951-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb951-4"><a href="defining-your-own-functions.html#cb951-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb951-5"><a href="defining-your-own-functions.html#cb951-5" aria-hidden="true" tabindex="-1"></a><span class="fu">average_and_sd</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## $mean_x
## [1] 7.166667
## 
## $sd_x
## [1] 4.262237</code></pre>
<p>As described before, you can use <code>return()</code> at the end of your functions:</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="defining-your-own-functions.html#cb953-1" aria-hidden="true" tabindex="-1"></a>average_and_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb953-2"><a href="defining-your-own-functions.html#cb953-2" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span>
<span id="cb953-3"><a href="defining-your-own-functions.html#cb953-3" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(result)</span>
<span id="cb953-4"><a href="defining-your-own-functions.html#cb953-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb953-5"><a href="defining-your-own-functions.html#cb953-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb953-6"><a href="defining-your-own-functions.html#cb953-6" aria-hidden="true" tabindex="-1"></a><span class="fu">average_and_sd</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## [1] 7.166667 4.262237</code></pre>
<p>But this is only needed if you need to return a value early:</p>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="defining-your-own-functions.html#cb955-1" aria-hidden="true" tabindex="-1"></a>average_and_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb955-2"><a href="defining-your-own-functions.html#cb955-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(x))){</span>
<span id="cb955-3"><a href="defining-your-own-functions.html#cb955-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb955-4"><a href="defining-your-own-functions.html#cb955-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb955-5"><a href="defining-your-own-functions.html#cb955-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span>
<span id="cb955-6"><a href="defining-your-own-functions.html#cb955-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb955-7"><a href="defining-your-own-functions.html#cb955-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb955-8"><a href="defining-your-own-functions.html#cb955-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb955-9"><a href="defining-your-own-functions.html#cb955-9" aria-hidden="true" tabindex="-1"></a><span class="fu">average_and_sd</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## [1] 7.166667 4.262237</code></pre>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb957-1"><a href="defining-your-own-functions.html#cb957-1" aria-hidden="true" tabindex="-1"></a><span class="fu">average_and_sd</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>If you need to use a function from a package inside your function use <code>::</code>:</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="defining-your-own-functions.html#cb959-1" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a_vector){</span>
<span id="cb959-2"><a href="defining-your-own-functions.html#cb959-2" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">reduce</span>(a_vector, <span class="st">`</span><span class="at">+</span><span class="st">`</span>)</span>
<span id="cb959-3"><a href="defining-your-own-functions.html#cb959-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>However, if you need to use more than one function, this can become tedious. A quick and dirty
way of doing that, is to use <code>library(package_name)</code>, inside the function:</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="defining-your-own-functions.html#cb960-1" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a_vector){</span>
<span id="cb960-2"><a href="defining-your-own-functions.html#cb960-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(purrr)</span>
<span id="cb960-3"><a href="defining-your-own-functions.html#cb960-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(a_vector, <span class="st">`</span><span class="at">+</span><span class="st">`</span>)</span>
<span id="cb960-4"><a href="defining-your-own-functions.html#cb960-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Loading the library inside the function has the advantage that you will be sure that the package
upon which your function depends will be loaded. If the package is already loaded, it will not be
loaded again, thus not impact performance, but if you forgot to load it at the beginning of your
script, then, no worries, your function will load it the first time you use it! However, you should
avoid doing this, because the resulting function is now not pure. It has a side effect, which is
loading a library. This could result in problems, especially if several functions load several
different packages that have functions with the same name. Depending on which function runs first,
a function with the same name but coming from the same package will be available in the global
environment. The very best way would be to write your own package and declare the packages upon
which your functions depend as dependencies. This is something we are going to explore in Chapter
9.</p>
<p>You can put a lot of instructions inside a function, such as loops. Let’s create the function that
returns Fionacci numbers.</p>
</div>
<div id="fibonacci-numbers" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Fibonacci numbers<a href="defining-your-own-functions.html#fibonacci-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Fibonacci sequence is the following:</p>
<p><span class="math display">\[1, 1, 2, 3, 5, 8, 13, 21, 34, 55, ...\]</span></p>
<p>Each subsequent number is composed of the sum of the two preceding ones. In R, it is possible to define a function that returns the <span class="math inline">\(n^{th}\)</span> fibonacci number:</p>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="defining-your-own-functions.html#cb961-1" aria-hidden="true" tabindex="-1"></a>my_fibo <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb961-2"><a href="defining-your-own-functions.html#cb961-2" aria-hidden="true" tabindex="-1"></a> a <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb961-3"><a href="defining-your-own-functions.html#cb961-3" aria-hidden="true" tabindex="-1"></a> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb961-4"><a href="defining-your-own-functions.html#cb961-4" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb961-5"><a href="defining-your-own-functions.html#cb961-5" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> b</span>
<span id="cb961-6"><a href="defining-your-own-functions.html#cb961-6" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> a</span>
<span id="cb961-7"><a href="defining-your-own-functions.html#cb961-7" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> a <span class="sc">+</span> temp</span>
<span id="cb961-8"><a href="defining-your-own-functions.html#cb961-8" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb961-9"><a href="defining-your-own-functions.html#cb961-9" aria-hidden="true" tabindex="-1"></a> a</span>
<span id="cb961-10"><a href="defining-your-own-functions.html#cb961-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Inside the loop, we defined a variable called <code>temp</code>. Defining temporary variables is usually very
useful. Let’s try to understand what happens inside this loop:</p>
<ul>
<li>First, we assign the value 0 to variable <code>a</code> and value 1 to variable <code>b</code>.</li>
<li>We start a loop, that goes from 1 to <code>n</code>.</li>
<li>We assign the value inside of <code>b</code> to a temporary variable, called <code>temp</code>.</li>
<li><code>b</code> becomes <code>a</code>.</li>
<li>We assign the sum of <code>a</code> and <code>temp</code> to <code>a</code>.</li>
<li>When the loop is finished, we return <code>a</code>.</li>
</ul>
<p>What happens if we want the 3rd fibonacci number? At <code>n = 1</code> we have first <code>a = 0</code> and <code>b = 1</code>,
then <code>temp = 1</code>, <code>b = 0</code> and <code>a = 0 + 1</code>. Then <code>n = 2</code>. Now <code>b = 0</code> and <code>temp = 0</code>. The previous
result, <code>a = 0 + 1</code> is now assigned to <code>b</code>, so <code>b = 1</code>. Then, <code>a = 1 + 0</code>. Finally, <code>n = 3</code>. <code>temp = 1</code> (because <code>b = 1</code>), the previous result <code>a = 1</code> is assigned to <code>b</code> and finally, <code>a = 1 + 1</code>. So
the third fibonacci number equals 2. Reading this might be a bit confusing; I strongly advise you
to run the algorithm on a sheet of paper, step by step.</p>
<p>The above algorithm is called an iterative algorithm, because it uses a loop to compute the result.
Let’s look at another way to think about the problem, with a so-called recursive function:</p>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="defining-your-own-functions.html#cb962-1" aria-hidden="true" tabindex="-1"></a>fibo_recur <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb962-2"><a href="defining-your-own-functions.html#cb962-2" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (n <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> n <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb962-3"><a href="defining-your-own-functions.html#cb962-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(n)</span>
<span id="cb962-4"><a href="defining-your-own-functions.html#cb962-4" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> {</span>
<span id="cb962-5"><a href="defining-your-own-functions.html#cb962-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">fibo_recur</span>(n<span class="dv">-1</span>) <span class="sc">+</span> <span class="fu">fibo_recur</span>(n<span class="dv">-2</span>)</span>
<span id="cb962-6"><a href="defining-your-own-functions.html#cb962-6" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb962-7"><a href="defining-your-own-functions.html#cb962-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This algorithm should be easier to understand: if <code>n = 0</code> or <code>n = 1</code> the function should return <code>n</code>
(0 or 1). If <code>n</code> is strictly bigger than <code>1</code>, <code>fibo_recur()</code> should return the sum of
<code>fibo_recur(n-1)</code> and <code>fibo_recur(n-2)</code>. This version of the function is very much the same as the
mathematical definition of the fibonacci sequence. So why not use only recursive algorithms
then? Try to run the following:</p>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="defining-your-own-functions.html#cb963-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">my_fibo</span>(<span class="dv">30</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.007   0.000   0.007</code></pre>
<p>The result should be printed very fast (the <code>system.time()</code> function returns the time that it took
to execute <code>my_fibo(30)</code>). Let’s try with the recursive version:</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="defining-your-own-functions.html#cb965-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">fibo_recur</span>(<span class="dv">30</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   1.482   0.080   1.574</code></pre>
<p>It takes much longer to execute! Recursive algorithms are very CPU demanding, so if speed is
critical, it’s best to avoid recursive algorithms. Also, in <code>fibo_recur()</code> try to remove this line:
<code>if (n == 0 || n == 1)</code> and try to run <code>fibo_recur(5)</code> and see what happens. You should
get an error: this is because for recursive algorithms you need a stopping condition, or else,
it would run forever. This is not the case for iterative algorithms, because the stopping
condition is the last step of the loop.</p>
<p>So as you can see, for recursive relationships, for or while loops are the way to go in R, whether
you’re writing these loops inside functions or not.</p>
</div>
</div>
<div id="exercises-4" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Exercises<a href="defining-your-own-functions.html#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-1-4" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1<a href="defining-your-own-functions.html#exercise-1-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this exercise, you will write a function to compute the sum of the n first integers. Combine the
algorithm we saw in section about while loops and what you learned about functions
in this section.</p>
</div>
<div id="exercise-2-2" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2<a href="defining-your-own-functions.html#exercise-2-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a function called <code>my_fact()</code> that computes the factorial of a number <code>n</code>. Do it using a
loop, using a recursive function, and using a functional:</p>
</div>
<div id="exercise-3-2" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3<a href="defining-your-own-functions.html#exercise-3-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a function to find the roots of quadratic functions. Your function should take 3 arguments,
<code>a</code>, <code>b</code> and <code>c</code> and return the two roots. Only consider the case where there are two real roots
(delta &gt; 0).</p>
</div>
</div>
<div id="functions-that-take-functions-as-arguments-writing-your-own-higher-order-functions" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Functions that take functions as arguments: writing your own higher-order functions<a href="defining-your-own-functions.html#functions-that-take-functions-as-arguments-writing-your-own-higher-order-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Functions that take functions as arguments are very powerful and useful tools.
Two very important functions, that we will discuss in chapter 8 are <code>purrr::map()</code>
and <code>purrr::reduce()</code>. But you can also write your own! A very simple example
would be the following:</p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="defining-your-own-functions.html#cb967-1" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="cf">function</span>(x, func){</span>
<span id="cb967-2"><a href="defining-your-own-functions.html#cb967-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">func</span>(x)</span>
<span id="cb967-3"><a href="defining-your-own-functions.html#cb967-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>my_func()</code> is a very simple function that takes <code>x</code> and <code>func()</code> as arguments and that simply
executes <code>func(x)</code>. This might not seem very useful (after all, you could simply use <code>func(x)!</code>) but
this is just for illustration purposes, in practice, your functions would be more useful than that!
Let’s try to use <code>my_func()</code>:</p>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb968-1"><a href="defining-your-own-functions.html#cb968-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">8</span>), mean)</span></code></pre></div>
<pre><code>## [1] 3.6</code></pre>
<p>As expected, this returns the mean of the given vector. But now suppose the following:</p>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="defining-your-own-functions.html#cb970-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">8</span>), mean)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Because one element of the list is <code>NA</code>, the whole mean is <code>NA</code>. <code>mean()</code> has a <code>na.rm</code> argument
that you can set to <code>TRUE</code> to ignore the <code>NA</code>s in the vector. However, here, there is no way to
provide this argument to the function <code>mean()</code>! Let’s see what happens when we try to:</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="defining-your-own-functions.html#cb972-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">8</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>Error in my_func(c(1, 8, 1, NA, 8), mean, na.rm = TRUE) :
  unused argument (na.rm = TRUE)</code></pre>
<p>So what you could do is pass the value <code>TRUE</code> to the <code>na.rm</code> argument of <code>mean()</code> from your own
function:</p>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="defining-your-own-functions.html#cb974-1" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="cf">function</span>(x, func, remove_na){</span>
<span id="cb974-2"><a href="defining-your-own-functions.html#cb974-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">func</span>(x, <span class="at">na.rm =</span> remove_na)</span>
<span id="cb974-3"><a href="defining-your-own-functions.html#cb974-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb974-4"><a href="defining-your-own-functions.html#cb974-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb974-5"><a href="defining-your-own-functions.html#cb974-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">8</span>), mean, <span class="at">remove_na =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 4.5</code></pre>
<p>This is one solution, but <code>mean()</code> also has another argument called <code>trim</code>. What if some other
user needs this argument? Should you also add it to your function? Surely there’s a way to avoid
this problem? Yes, there is, and it by using the <em>dots</em>. The <code>...</code> simply mean “any other
argument as needed”, and it’s very easy to use:</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="defining-your-own-functions.html#cb976-1" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="cf">function</span>(x, func, ...){</span>
<span id="cb976-2"><a href="defining-your-own-functions.html#cb976-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">func</span>(x, ...)</span>
<span id="cb976-3"><a href="defining-your-own-functions.html#cb976-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb976-4"><a href="defining-your-own-functions.html#cb976-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-5"><a href="defining-your-own-functions.html#cb976-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">8</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 4.5</code></pre>
<p>or, now, if you need the <code>trim</code> argument:</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="defining-your-own-functions.html#cb978-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">8</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 4.5</code></pre>
<p>The <code>...</code> are very useful when writing higher-order functions such as <code>my_func()</code>, because it allows
you to pass arguments <em>down</em> to the underlying functions.</p>
</div>
<div id="functions-that-return-functions" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Functions that return functions<a href="defining-your-own-functions.html#functions-that-return-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The example from before, <code>my_func()</code> took three arguments, some <code>x</code>, a function <code>func</code>, and <code>...</code> (dots). <code>my_func()</code>
was a kind of wrapper that evaluated <code>func</code> on its arguments <code>x</code> and <code>...</code>. But sometimes this is not quite what you
need or want. It is sometimes useful to write a function that returns a modified function. This type of function
is called a function factory, as it <em>builds</em> functions. For instance, suppose that we want to time how long functions
take to run. An idea would be to proceed like this:</p>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="defining-your-own-functions.html#cb980-1" aria-hidden="true" tabindex="-1"></a>tic <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb980-2"><a href="defining-your-own-functions.html#cb980-2" aria-hidden="true" tabindex="-1"></a><span class="fu">very_slow_function</span>(x)</span>
<span id="cb980-3"><a href="defining-your-own-functions.html#cb980-3" aria-hidden="true" tabindex="-1"></a>toc <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb980-4"><a href="defining-your-own-functions.html#cb980-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb980-5"><a href="defining-your-own-functions.html#cb980-5" aria-hidden="true" tabindex="-1"></a>running_time <span class="ot">&lt;-</span> toc <span class="sc">-</span> tic</span></code></pre></div>
<p>but if you want to time several functions, this gets very tedious. It would be much easier if functions would
time <em>themselves</em>. We could achieve this by writing a wrapper, like this:</p>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="defining-your-own-functions.html#cb981-1" aria-hidden="true" tabindex="-1"></a>timed_very_slow_function <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb981-2"><a href="defining-your-own-functions.html#cb981-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb981-3"><a href="defining-your-own-functions.html#cb981-3" aria-hidden="true" tabindex="-1"></a>  tic <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb981-4"><a href="defining-your-own-functions.html#cb981-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">very_slow_function</span>(x)</span>
<span id="cb981-5"><a href="defining-your-own-functions.html#cb981-5" aria-hidden="true" tabindex="-1"></a>  toc <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb981-6"><a href="defining-your-own-functions.html#cb981-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb981-7"><a href="defining-your-own-functions.html#cb981-7" aria-hidden="true" tabindex="-1"></a>  running_time <span class="ot">&lt;-</span> toc <span class="sc">-</span> tic</span>
<span id="cb981-8"><a href="defining-your-own-functions.html#cb981-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb981-9"><a href="defining-your-own-functions.html#cb981-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;result&quot;</span> <span class="ot">=</span> result,</span>
<span id="cb981-10"><a href="defining-your-own-functions.html#cb981-10" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;running_time&quot;</span> <span class="ot">=</span> running_time)</span>
<span id="cb981-11"><a href="defining-your-own-functions.html#cb981-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb981-12"><a href="defining-your-own-functions.html#cb981-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The problem here is that we have to change each function we need to time. But thanks to the concept of function
factories, we can write a function that does this for us:</p>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="defining-your-own-functions.html#cb982-1" aria-hidden="true" tabindex="-1"></a>time_f <span class="ot">&lt;-</span> <span class="cf">function</span>(.f, ...){</span>
<span id="cb982-2"><a href="defining-your-own-functions.html#cb982-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb982-3"><a href="defining-your-own-functions.html#cb982-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(...){</span>
<span id="cb982-4"><a href="defining-your-own-functions.html#cb982-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb982-5"><a href="defining-your-own-functions.html#cb982-5" aria-hidden="true" tabindex="-1"></a>    tic <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb982-6"><a href="defining-your-own-functions.html#cb982-6" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">.f</span>(...)</span>
<span id="cb982-7"><a href="defining-your-own-functions.html#cb982-7" aria-hidden="true" tabindex="-1"></a>    toc <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb982-8"><a href="defining-your-own-functions.html#cb982-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb982-9"><a href="defining-your-own-functions.html#cb982-9" aria-hidden="true" tabindex="-1"></a>    running_time <span class="ot">&lt;-</span> toc <span class="sc">-</span> tic</span>
<span id="cb982-10"><a href="defining-your-own-functions.html#cb982-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb982-11"><a href="defining-your-own-functions.html#cb982-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="st">&quot;result&quot;</span> <span class="ot">=</span> result,</span>
<span id="cb982-12"><a href="defining-your-own-functions.html#cb982-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;running_time&quot;</span> <span class="ot">=</span> running_time)</span>
<span id="cb982-13"><a href="defining-your-own-functions.html#cb982-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb982-14"><a href="defining-your-own-functions.html#cb982-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb982-15"><a href="defining-your-own-functions.html#cb982-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>time_f()</code> is a function that returns a function, a function factory. Calling it on a function returns, as expected,
a function:</p>
<div class="sourceCode" id="cb983"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb983-1"><a href="defining-your-own-functions.html#cb983-1" aria-hidden="true" tabindex="-1"></a>t_mean <span class="ot">&lt;-</span> <span class="fu">time_f</span>(mean)</span>
<span id="cb983-2"><a href="defining-your-own-functions.html#cb983-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb983-3"><a href="defining-your-own-functions.html#cb983-3" aria-hidden="true" tabindex="-1"></a>t_mean</span></code></pre></div>
<pre><code>## function(...){
## 
##     tic &lt;- Sys.time()
##     result &lt;- .f(...)
##     toc &lt;- Sys.time()
## 
##     running_time &lt;- toc - tic
## 
##     list(&quot;result&quot; = result,
##          &quot;running_time&quot; = running_time)
## 
##   }
## &lt;environment: 0x562c5699a6b8&gt;</code></pre>
<p>This function can now be used like any other function:</p>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb985-1"><a href="defining-your-own-functions.html#cb985-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">t_mean</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">500000</span>, <span class="dv">500000</span>))</span></code></pre></div>
<p><code>output</code> is a list of two elements, the first being simply the result of <code>mean(seq(-500000, 500000))</code>, and the other
being the running time.</p>
<p>This approach is super flexible. For instance, imagine that there is an <code>NA</code> in the vector. This would result in
the mean of this vector being <code>NA</code>:</p>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="defining-your-own-functions.html#cb986-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t_mean</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">500000</span>, <span class="dv">500000</span>)))</span></code></pre></div>
<pre><code>## $result
## [1] NA
## 
## $running_time
## Time difference of 0.006885529 secs</code></pre>
<p>But because we use the <code>...</code> in the definition of <code>time_f()</code>, we can now simply pass <code>mean()</code>’s option down to it:</p>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="defining-your-own-functions.html#cb988-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t_mean</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">500000</span>, <span class="dv">500000</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $result
## [1] 0
## 
## $running_time
## Time difference of 0.01394773 secs</code></pre>
</div>
<div id="functions-that-take-columns-of-data-as-arguments" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Functions that take columns of data as arguments<a href="defining-your-own-functions.html#functions-that-take-columns-of-data-as-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-enquo---approach" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> The <code>enquo() - !!()</code> approach<a href="defining-your-own-functions.html#the-enquo---approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In many situations, you will want to write functions that look similar to this:</p>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="defining-your-own-functions.html#cb990-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(my_data, one_column_inside_data)</span></code></pre></div>
<p>Such a function would be useful in situation where you have to apply a certain number of operations
to columns for different data frames. For example if you need to create tables of descriptive
statistics or graphs periodically, it might be very interesting to put these operations inside a
function and then call the function whenever you need it, on the fresh batch of data.</p>
<p>However, if you try to write something like that, something that might seem unexpected, at first,
will happen:</p>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="defining-your-own-functions.html#cb991-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb991-2"><a href="defining-your-own-functions.html#cb991-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb991-3"><a href="defining-your-own-functions.html#cb991-3" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, col_name){</span>
<span id="cb991-4"><a href="defining-your-own-functions.html#cb991-4" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb991-5"><a href="defining-your-own-functions.html#cb991-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(col_name) <span class="sc">%&gt;%</span></span>
<span id="cb991-6"><a href="defining-your-own-functions.html#cb991-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_speed =</span> <span class="fu">mean</span>(speed))</span>
<span id="cb991-7"><a href="defining-your-own-functions.html#cb991-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb991-8"><a href="defining-your-own-functions.html#cb991-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb991-9"><a href="defining-your-own-functions.html#cb991-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb991-10"><a href="defining-your-own-functions.html#cb991-10" aria-hidden="true" tabindex="-1"></a><span class="fu">simple_function</span>(cars, <span class="st">&quot;dist&quot;</span>)</span></code></pre></div>
<pre><code>Error: unknown variable to group by : col_name</code></pre>
<p>The variable <code>col_name</code> is passed to <code>simple_function()</code> as a string, but <code>group_by()</code> requires a
variable name. So why not try to convert <code>col_name</code> to a name?</p>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="defining-your-own-functions.html#cb993-1" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, col_name){</span>
<span id="cb993-2"><a href="defining-your-own-functions.html#cb993-2" aria-hidden="true" tabindex="-1"></a>  col_name <span class="ot">&lt;-</span> <span class="fu">as.name</span>(col_name)</span>
<span id="cb993-3"><a href="defining-your-own-functions.html#cb993-3" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb993-4"><a href="defining-your-own-functions.html#cb993-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(col_name) <span class="sc">%&gt;%</span></span>
<span id="cb993-5"><a href="defining-your-own-functions.html#cb993-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_speed =</span> <span class="fu">mean</span>(speed))</span>
<span id="cb993-6"><a href="defining-your-own-functions.html#cb993-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb993-7"><a href="defining-your-own-functions.html#cb993-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb993-8"><a href="defining-your-own-functions.html#cb993-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb993-9"><a href="defining-your-own-functions.html#cb993-9" aria-hidden="true" tabindex="-1"></a><span class="fu">simple_function</span>(cars, <span class="st">&quot;dist&quot;</span>)</span></code></pre></div>
<pre><code>Error: unknown variable to group by : col_name</code></pre>
<p>This is because R is literally looking for the variable <code>"dist"</code> somewhere in the global
environment, and not as a column of the data. R does not understand that you are refering to the
column <code>"dist"</code> that is inside the dataset. So how can we make R understands what you mean?</p>
<p>To be able to do that, we need to use a framework that was introduced in the <code>{tidyverse}</code>,
called <em>tidy evaluation</em>. This framework can be used by installing the <code>{rlang}</code> package.
<code>{rlang}</code> is quite a technical package, so I will spare you the details. But you should at
the very least take a look at the following documents
<a href="http://dplyr.tidyverse.org/articles/programming.html">here</a> and
<a href="https://rlang.r-lib.org/reference/topic-data-mask.html">here</a>. The
discussion can get complicated, but you don’t need to know everything about <code>{rlang}</code>.
As you will see, knowing some of the capabilities <code>{rlang}</code> provides can be incredibly useful.
Take a look at the code below:</p>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="defining-your-own-functions.html#cb995-1" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, col_name){</span>
<span id="cb995-2"><a href="defining-your-own-functions.html#cb995-2" aria-hidden="true" tabindex="-1"></a>  col_name <span class="ot">&lt;-</span> <span class="fu">enquo</span>(col_name)</span>
<span id="cb995-3"><a href="defining-your-own-functions.html#cb995-3" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb995-4"><a href="defining-your-own-functions.html#cb995-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span>col_name) <span class="sc">%&gt;%</span></span>
<span id="cb995-5"><a href="defining-your-own-functions.html#cb995-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_mpg =</span> <span class="fu">mean</span>(mpg))</span>
<span id="cb995-6"><a href="defining-your-own-functions.html#cb995-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb995-7"><a href="defining-your-own-functions.html#cb995-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb995-8"><a href="defining-your-own-functions.html#cb995-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb995-9"><a href="defining-your-own-functions.html#cb995-9" aria-hidden="true" tabindex="-1"></a><span class="fu">simple_function</span>(mtcars, cyl)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##     cyl mean_mpg
##   &lt;dbl&gt;    &lt;dbl&gt;
## 1     4     26.7
## 2     6     19.7
## 3     8     15.1</code></pre>
<p>As you can see, the previous idea we had, which was using <code>as.name()</code> was not very far away from
the solution. The solution, with <code>{rlang}</code>, consists in using <code>enquo()</code>, which (for our purposes),
does something similar to <code>as.name()</code>. Now that <code>col_name</code> is (R programmers call it) quoted, or
<em>defused</em>, we need to tell <code>group_by()</code> to evaluate the input as is. This is done with <code>!!()</code>,
called the <a href="https://rlang.r-lib.org/reference/injection-operator.html">injection operator</a>, which
is another <code>{rlang}</code> function. I say it again; don’t worry if you don’t understand everything. Just
remember to use <code>enquo()</code> on your column names and then <code>!!()</code> inside the <code>{dplyr}</code> function you
want to use.</p>
<p>Let’s see some other examples:</p>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="defining-your-own-functions.html#cb997-1" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, col_name, value){</span>
<span id="cb997-2"><a href="defining-your-own-functions.html#cb997-2" aria-hidden="true" tabindex="-1"></a>  col_name <span class="ot">&lt;-</span> <span class="fu">enquo</span>(col_name)</span>
<span id="cb997-3"><a href="defining-your-own-functions.html#cb997-3" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb997-4"><a href="defining-your-own-functions.html#cb997-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>((<span class="sc">!!</span>col_name) <span class="sc">==</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb997-5"><a href="defining-your-own-functions.html#cb997-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_cyl =</span> <span class="fu">mean</span>(cyl))</span>
<span id="cb997-6"><a href="defining-your-own-functions.html#cb997-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb997-7"><a href="defining-your-own-functions.html#cb997-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb997-8"><a href="defining-your-own-functions.html#cb997-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb997-9"><a href="defining-your-own-functions.html#cb997-9" aria-hidden="true" tabindex="-1"></a><span class="fu">simple_function</span>(mtcars, am, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##   mean_cyl
## 1 5.076923</code></pre>
<p>Notice that I’ve written:</p>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="defining-your-own-functions.html#cb999-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>((<span class="sc">!!</span>col_name) <span class="sc">==</span> value)</span></code></pre></div>
<p>and not:</p>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="defining-your-own-functions.html#cb1000-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!!</span>col_name <span class="sc">==</span> value)</span></code></pre></div>
<p>I have enclosed <code>!!col_name</code> inside parentheses. This is because operators such as <code>==</code> have
precedence over <code>!!</code>, so you have to be explicit. Also, notice that I didn’t have to quote <code>1</code>.
This is because it’s <em>standard</em> variable, not a column inside the dataset. Let’s make this function
a bit more general. I hard-coded the variable cyl inside the body of the function, but maybe you’d
like the mean of another variable?</p>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1001-1"><a href="defining-your-own-functions.html#cb1001-1" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, filter_col, mean_col, value){</span>
<span id="cb1001-2"><a href="defining-your-own-functions.html#cb1001-2" aria-hidden="true" tabindex="-1"></a>  filter_col <span class="ot">&lt;-</span> <span class="fu">enquo</span>(filter_col)</span>
<span id="cb1001-3"><a href="defining-your-own-functions.html#cb1001-3" aria-hidden="true" tabindex="-1"></a>  mean_col <span class="ot">&lt;-</span> <span class="fu">enquo</span>(mean_col)</span>
<span id="cb1001-4"><a href="defining-your-own-functions.html#cb1001-4" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb1001-5"><a href="defining-your-own-functions.html#cb1001-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>((<span class="sc">!!</span>filter_col) <span class="sc">==</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb1001-6"><a href="defining-your-own-functions.html#cb1001-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">mean</span>((<span class="sc">!!</span>mean_col)))</span>
<span id="cb1001-7"><a href="defining-your-own-functions.html#cb1001-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1001-8"><a href="defining-your-own-functions.html#cb1001-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1001-9"><a href="defining-your-own-functions.html#cb1001-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1001-10"><a href="defining-your-own-functions.html#cb1001-10" aria-hidden="true" tabindex="-1"></a><span class="fu">simple_function</span>(mtcars, am, cyl, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##   mean(cyl)
## 1  5.076923</code></pre>
<p>Notice that I had to quote <code>mean_col</code> too.</p>
<p>Using the <code>...</code> that we discovered in the previous section, we can pass more than one column:</p>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="defining-your-own-functions.html#cb1003-1" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, ...){</span>
<span id="cb1003-2"><a href="defining-your-own-functions.html#cb1003-2" aria-hidden="true" tabindex="-1"></a>  col_vars <span class="ot">&lt;-</span> <span class="fu">quos</span>(...)</span>
<span id="cb1003-3"><a href="defining-your-own-functions.html#cb1003-3" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb1003-4"><a href="defining-your-own-functions.html#cb1003-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">!!!</span>col_vars), <span class="fu">funs</span>(mean, sd))</span>
<span id="cb1003-5"><a href="defining-your-own-functions.html#cb1003-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Because these <em>dots</em> contain more than one variable, you have to use <code>quos()</code> instead of <code>enquo()</code>.
This will put the arguments provided via the dots in a list. Then, because we have a list of
columns, we have to use <code>summarise_at()</code>, which you should know if you did the exercices of
Chapter 4. So if you didn’t do them, go back to them and finish them first. Doing the exercise will
also teach you what <code>vars()</code> and <code>funs()</code> are. The last thing you have to pay attention to is to
use <code>!!!()</code> if you used <code>quos()</code>. So 3 <code>!</code> instead of only 2. This allows you to then do things
like this:</p>
<div class="sourceCode" id="cb1004"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1004-1"><a href="defining-your-own-functions.html#cb1004-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simple_function</span>(mtcars, am, cyl, mpg)</span></code></pre></div>
<pre><code>## Warning: `funs()` was deprecated in dplyr 0.8.0.
## Please use a list of either functions or lambdas: 
## 
##   # Simple named list: 
##   list(mean = mean, median = median)
## 
##   # Auto named with `tibble::lst()`: 
##   tibble::lst(mean, median)
## 
##   # Using lambdas
##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</code></pre>
<pre><code>##   am_mean cyl_mean mpg_mean     am_sd   cyl_sd   mpg_sd
## 1 0.40625   6.1875 20.09062 0.4989909 1.785922 6.026948</code></pre>
<p>Using <code>...</code> with <code>!!!()</code> allows you to write very flexible functions.</p>
<p>If you need to be even more general, you can also provide the summary functions as arguments of
your function, but you have to rewrite your function a little bit:</p>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="defining-your-own-functions.html#cb1007-1" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, cols, funcs){</span>
<span id="cb1007-2"><a href="defining-your-own-functions.html#cb1007-2" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb1007-3"><a href="defining-your-own-functions.html#cb1007-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">!!!</span>cols), <span class="fu">funs</span>(<span class="sc">!!!</span>funcs))</span>
<span id="cb1007-4"><a href="defining-your-own-functions.html#cb1007-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>You might be wondering where the <code>quos()</code> went? Well because now we are passing two lists, a list of
columns that we have to quote, and a list of functions, that we also have to quote, we need to use <code>quos()</code>
when calling the function:</p>
<div class="sourceCode" id="cb1008"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1008-1"><a href="defining-your-own-functions.html#cb1008-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simple_function</span>(mtcars, <span class="fu">quos</span>(am, cyl, mpg), <span class="fu">quos</span>(mean, sd, sum))</span></code></pre></div>
<pre><code>##   am_mean cyl_mean mpg_mean     am_sd   cyl_sd   mpg_sd am_sum cyl_sum mpg_sum
## 1 0.40625   6.1875 20.09062 0.4989909 1.785922 6.026948     13     198   642.9</code></pre>
<p>This works, but I don’t think you’ll need to have that much flexibility; either the columns
are variables, or the functions, but rarely both at the same time.</p>
<p>To conclude this function, I should also talk about <code>as_label()</code> which allows you to change the
name of a variable, for instance if you want to call the resulting column <code>mean_mpg</code> when you
compute the mean of the <code>mpg</code> column:</p>
<div class="sourceCode" id="cb1010"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1010-1"><a href="defining-your-own-functions.html#cb1010-1" aria-hidden="true" tabindex="-1"></a>simple_function <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, filter_col, mean_col, value){</span>
<span id="cb1010-2"><a href="defining-your-own-functions.html#cb1010-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1010-3"><a href="defining-your-own-functions.html#cb1010-3" aria-hidden="true" tabindex="-1"></a>  filter_col <span class="ot">&lt;-</span> <span class="fu">enquo</span>(filter_col)</span>
<span id="cb1010-4"><a href="defining-your-own-functions.html#cb1010-4" aria-hidden="true" tabindex="-1"></a>  mean_col <span class="ot">&lt;-</span> <span class="fu">enquo</span>(mean_col)</span>
<span id="cb1010-5"><a href="defining-your-own-functions.html#cb1010-5" aria-hidden="true" tabindex="-1"></a>  mean_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;mean_&quot;</span>, <span class="fu">as_label</span>(mean_col))</span>
<span id="cb1010-6"><a href="defining-your-own-functions.html#cb1010-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1010-7"><a href="defining-your-own-functions.html#cb1010-7" aria-hidden="true" tabindex="-1"></a>  dataset <span class="sc">%&gt;%</span></span>
<span id="cb1010-8"><a href="defining-your-own-functions.html#cb1010-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>((<span class="sc">!!</span>filter_col) <span class="sc">==</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb1010-9"><a href="defining-your-own-functions.html#cb1010-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="sc">!!</span>(mean_name) <span class="sc">:</span><span class="er">=</span> <span class="fu">mean</span>((<span class="sc">!!</span>mean_col)))</span>
<span id="cb1010-10"><a href="defining-your-own-functions.html#cb1010-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Pay attention to the <code>:=</code> operator in the last line. This is needed when using <code>as_label()</code>.</p>
</div>
<div id="curly-curly-a-simplified-approach-to-enquo-and" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Curly Curly, a simplified approach to <code>enquo()</code> and <code>!!()</code><a href="defining-your-own-functions.html#curly-curly-a-simplified-approach-to-enquo-and" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The previous section might have been a bit difficult to grasp, but there is a simplified way of doing it,
which consists in using <code>{{}}</code>, introduced in <code>{rlang}</code> version 0.4.0.
The suggested pronunciation of <code>{{}}</code> is <em>curly-curly</em>, but there is no
<a href="https://twitter.com/JonTheGeek/status/1144815369766547456">consensus yet</a>.</p>
<p>Let’s suppose that I need to write a function that takes a data frame, as well as a column from
this data frame as arguments, just like before:</p>
<div class="sourceCode" id="cb1011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1011-1"><a href="defining-your-own-functions.html#cb1011-1" aria-hidden="true" tabindex="-1"></a>how_many_na <span class="ot">&lt;-</span> <span class="cf">function</span>(dataframe, column_name){</span>
<span id="cb1011-2"><a href="defining-your-own-functions.html#cb1011-2" aria-hidden="true" tabindex="-1"></a>  dataframe <span class="sc">%&gt;%</span></span>
<span id="cb1011-3"><a href="defining-your-own-functions.html#cb1011-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">is.na</span>(column_name)) <span class="sc">%&gt;%</span></span>
<span id="cb1011-4"><a href="defining-your-own-functions.html#cb1011-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>()</span>
<span id="cb1011-5"><a href="defining-your-own-functions.html#cb1011-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s try this function out on the <code>starwars</code> data:</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1012-1"><a href="defining-your-own-functions.html#cb1012-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(starwars)</span>
<span id="cb1012-2"><a href="defining-your-own-functions.html#cb1012-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1012-3"><a href="defining-your-own-functions.html#cb1012-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(starwars)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 14
##   name         height  mass hair_…¹ skin_…² eye_c…³ birth…⁴ sex   gender homew…⁵
##   &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  
## 1 Luke Skywal…    172    77 blond   fair    blue       19   male  mascu… Tatooi…
## 2 C-3PO           167    75 &lt;NA&gt;    gold    yellow    112   none  mascu… Tatooi…
## 3 R2-D2            96    32 &lt;NA&gt;    white,… red        33   none  mascu… Naboo  
## 4 Darth Vader     202   136 none    white   yellow     41.9 male  mascu… Tatooi…
## 5 Leia Organa     150    49 brown   light   brown      19   fema… femin… Aldera…
## 6 Owen Lars       178   120 brown,… light   blue       52   male  mascu… Tatooi…
## # … with 4 more variables: species &lt;chr&gt;, films &lt;list&gt;, vehicles &lt;list&gt;,
## #   starships &lt;list&gt;, and abbreviated variable names ¹​hair_color, ²​skin_color,
## #   ³​eye_color, ⁴​birth_year, ⁵​homeworld</code></pre>
<p>As you can see, there are missing values in the <code>hair_color</code> column. Let’s try to count how many
missing values are in this column:</p>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="defining-your-own-functions.html#cb1014-1" aria-hidden="true" tabindex="-1"></a><span class="fu">how_many_na</span>(starwars, hair_color)</span></code></pre></div>
<pre><code>Error: object &#39;hair_color&#39; not found</code></pre>
<p>Just as expected, this does not work. The issue is that the column is inside the dataframe,
but when calling the function with <code>hair_color</code> as the second argument, R is looking for a
variable called <code>hair_color</code> that does not exist. What about trying with <code>"hair_color"</code>?</p>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="defining-your-own-functions.html#cb1016-1" aria-hidden="true" tabindex="-1"></a><span class="fu">how_many_na</span>(starwars, <span class="st">&quot;hair_color&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1     0</code></pre>
<p>Now we get something, but something wrong!</p>
<p>One way to solve this issue, is to not use the <code>filter()</code> function, and instead rely on base R:</p>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="defining-your-own-functions.html#cb1018-1" aria-hidden="true" tabindex="-1"></a>how_many_na_base <span class="ot">&lt;-</span> <span class="cf">function</span>(dataframe, column_name){</span>
<span id="cb1018-2"><a href="defining-your-own-functions.html#cb1018-2" aria-hidden="true" tabindex="-1"></a>  na_index <span class="ot">&lt;-</span> <span class="fu">is.na</span>(dataframe[, column_name])</span>
<span id="cb1018-3"><a href="defining-your-own-functions.html#cb1018-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>(dataframe[na_index, column_name])</span>
<span id="cb1018-4"><a href="defining-your-own-functions.html#cb1018-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1018-5"><a href="defining-your-own-functions.html#cb1018-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1018-6"><a href="defining-your-own-functions.html#cb1018-6" aria-hidden="true" tabindex="-1"></a><span class="fu">how_many_na_base</span>(starwars, <span class="st">&quot;hair_color&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>This works, but not using the <code>{tidyverse}</code> at all is not always an option. For instance,
the next function, which uses a grouping variable, would be difficult to implement without the
<code>{tidyverse}</code>:</p>
<div class="sourceCode" id="cb1020"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1020-1"><a href="defining-your-own-functions.html#cb1020-1" aria-hidden="true" tabindex="-1"></a>summarise_groups <span class="ot">&lt;-</span> <span class="cf">function</span>(dataframe, grouping_var, column_name){</span>
<span id="cb1020-2"><a href="defining-your-own-functions.html#cb1020-2" aria-hidden="true" tabindex="-1"></a>  dataframe <span class="sc">%&gt;%</span></span>
<span id="cb1020-3"><a href="defining-your-own-functions.html#cb1020-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(grouping_var) <span class="sc">%&gt;%</span>  </span>
<span id="cb1020-4"><a href="defining-your-own-functions.html#cb1020-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">mean</span>(column_name, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1020-5"><a href="defining-your-own-functions.html#cb1020-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Calling this function results in the following error message, as expected:</p>
<pre><code>Error: Column `grouping_var` is unknown</code></pre>
<p>In the previous section, we solved the issue like so:</p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1022-1"><a href="defining-your-own-functions.html#cb1022-1" aria-hidden="true" tabindex="-1"></a>summarise_groups <span class="ot">&lt;-</span> <span class="cf">function</span>(dataframe, grouping_var, column_name){</span>
<span id="cb1022-2"><a href="defining-your-own-functions.html#cb1022-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1022-3"><a href="defining-your-own-functions.html#cb1022-3" aria-hidden="true" tabindex="-1"></a>  grouping_var <span class="ot">&lt;-</span> <span class="fu">enquo</span>(grouping_var)</span>
<span id="cb1022-4"><a href="defining-your-own-functions.html#cb1022-4" aria-hidden="true" tabindex="-1"></a>  column_name <span class="ot">&lt;-</span> <span class="fu">enquo</span>(column_name)</span>
<span id="cb1022-5"><a href="defining-your-own-functions.html#cb1022-5" aria-hidden="true" tabindex="-1"></a>  mean_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;mean_&quot;</span>, <span class="fu">as_label</span>(column_name))</span>
<span id="cb1022-6"><a href="defining-your-own-functions.html#cb1022-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1022-7"><a href="defining-your-own-functions.html#cb1022-7" aria-hidden="true" tabindex="-1"></a>  dataframe <span class="sc">%&gt;%</span></span>
<span id="cb1022-8"><a href="defining-your-own-functions.html#cb1022-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span>grouping_var) <span class="sc">%&gt;%</span>  </span>
<span id="cb1022-9"><a href="defining-your-own-functions.html#cb1022-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="sc">!!</span>(mean_name) <span class="sc">:</span><span class="er">=</span> <span class="fu">mean</span>(<span class="sc">!!</span>column_name, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1022-10"><a href="defining-your-own-functions.html#cb1022-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The core of the function remained very similar to the version from before, but now one has to
use the <code>enquo()</code>-<code>!!</code> syntax.</p>
<p>Now this can be simplified using the new <code>{{}}</code> syntax:</p>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1023-1"><a href="defining-your-own-functions.html#cb1023-1" aria-hidden="true" tabindex="-1"></a>summarise_groups <span class="ot">&lt;-</span> <span class="cf">function</span>(dataframe, grouping_var, column_name){</span>
<span id="cb1023-2"><a href="defining-your-own-functions.html#cb1023-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1023-3"><a href="defining-your-own-functions.html#cb1023-3" aria-hidden="true" tabindex="-1"></a>  dataframe <span class="sc">%&gt;%</span></span>
<span id="cb1023-4"><a href="defining-your-own-functions.html#cb1023-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>({{grouping_var}}) <span class="sc">%&gt;%</span>  </span>
<span id="cb1023-5"><a href="defining-your-own-functions.html#cb1023-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>({{column_name}} <span class="sc">:</span><span class="er">=</span> <span class="fu">mean</span>({{column_name}}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1023-6"><a href="defining-your-own-functions.html#cb1023-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Much easier and cleaner! You still have to use the <code>:=</code> operator instead of <code>=</code> for the column name
however, and if you want to modify the column names, for instance in this
case return <code>"mean_height"</code> instead of <code>height</code> you have to keep using the <code>enquo()</code>-<code>!!</code> syntax.</p>
</div>
</div>
<div id="functions-that-use-loops" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Functions that use loops<a href="defining-your-own-functions.html#functions-that-use-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is entirely possible to put a loop inside a function. For example, consider the following
function that return the square root of a number using Newton’s algorithm:</p>
<div class="sourceCode" id="cb1024"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1024-1"><a href="defining-your-own-functions.html#cb1024-1" aria-hidden="true" tabindex="-1"></a>sqrt_newton <span class="ot">&lt;-</span> <span class="cf">function</span>(a, <span class="at">init =</span> <span class="dv">1</span>, <span class="at">eps =</span> <span class="fl">0.01</span>){</span>
<span id="cb1024-2"><a href="defining-your-own-functions.html#cb1024-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(a <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb1024-3"><a href="defining-your-own-functions.html#cb1024-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(<span class="fu">abs</span>(init<span class="sc">**</span><span class="dv">2</span> <span class="sc">-</span> a) <span class="sc">&gt;</span> eps){</span>
<span id="cb1024-4"><a href="defining-your-own-functions.html#cb1024-4" aria-hidden="true" tabindex="-1"></a>        init <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span>(init <span class="sc">+</span> a<span class="sc">/</span>init)</span>
<span id="cb1024-5"><a href="defining-your-own-functions.html#cb1024-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1024-6"><a href="defining-your-own-functions.html#cb1024-6" aria-hidden="true" tabindex="-1"></a>    init</span>
<span id="cb1024-7"><a href="defining-your-own-functions.html#cb1024-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This functions contains a while loop inside its body. Let’s see if it works:</p>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1025-1"><a href="defining-your-own-functions.html#cb1025-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt_newton</span>(<span class="dv">16</span>)</span></code></pre></div>
<pre><code>## [1] 4.000001</code></pre>
<p>In the definition of the function, I wrote <code>init = 1</code> and <code>eps = 0.01</code> which means that this
argument can be omitted and will have the provided value (0.01) as the default. You can then use
this function as any other, for example with <code>map()</code>:</p>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1027-1"><a href="defining-your-own-functions.html#cb1027-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">12</span>), sqrt_newton)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4.000001
## 
## [[2]]
## [1] 2.645767
## 
## [[3]]
## [1] 2.828469
## 
## [[4]]
## [1] 3.000092
## 
## [[5]]
## [1] 3.464616</code></pre>
<p>This is what I meant before with “your functions are nothing special”. Once the function is
defined, you can use it like any other base R function.</p>
<p>Notice the use of <code>stopifnot()</code> inside the body of the function. This is a way to return an error
in case a condition is not fulfilled. We are going to learn more about this type of functions
in the next chapter.</p>
</div>
<div id="anonymous-functions" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Anonymous functions<a href="defining-your-own-functions.html#anonymous-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As the name implies, anonymous functions are functions that do not have a name. These are useful inside
functions that have functions as arguments, such as <code>purrr::map()</code> or <code>purrr::reduce()</code>:</p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1029-1"><a href="defining-your-own-functions.html#cb1029-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="cf">function</span>(x){<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(x)})</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 0.7071068
## 
## [[3]]
## [1] 0.5773503
## 
## [[4]]
## [1] 0.5</code></pre>
<p>These anonymous functions get defined in a very similar way to regular functions, you just skip the
name and that’s it. <code>{tidyverse}</code> functions also support formulas; these get converted to anonymous functions:</p>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1031-1"><a href="defining-your-own-functions.html#cb1031-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="sc">~</span>{<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(.)})</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 0.7071068
## 
## [[3]]
## [1] 0.5773503
## 
## [[4]]
## [1] 0.5</code></pre>
<p>Using a formula instead of an anonymous function is less verbose; you use <code>~</code> instead of <code>function(x)</code>
and a single dot <code>.</code> instead of <code>x</code>. What if you need an anonymous function that requires more than
one argument? This is not a problem:</p>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1033-1"><a href="defining-your-own-functions.html#cb1033-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>), <span class="cf">function</span>(x, y){(x<span class="sc">**</span><span class="dv">2</span>)<span class="sc">/</span>y})</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.1111111
## 
## [[2]]
## [1] 0.5
## 
## [[3]]
## [1] 1.285714
## 
## [[4]]
## [1] 2.666667
## 
## [[5]]
## [1] 5</code></pre>
<p>or, using a formula:</p>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1035-1"><a href="defining-your-own-functions.html#cb1035-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>), <span class="sc">~</span>{(.x<span class="sc">**</span><span class="dv">2</span>)<span class="sc">/</span>.y})</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.1111111
## 
## [[2]]
## [1] 0.5
## 
## [[3]]
## [1] 1.285714
## 
## [[4]]
## [1] 2.666667
## 
## [[5]]
## [1] 5</code></pre>
<p>Because you have now two arguments, a single dot could not work, so instead you use <code>.x</code> and <code>.y</code> to
avoid confusion.</p>
<p>Since version 4.1, R introduced a short-hand for defining anonymous functions:</p>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1037-1"><a href="defining-your-own-functions.html#cb1037-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), \(x)(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(x)))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 0.7071068
## 
## [[3]]
## [1] 0.5773503
## 
## [[4]]
## [1] 0.5</code></pre>
<p><code>\(x)</code> is supposed to look like this notation: <span class="math inline">\(\lambda(x)\)</span>. This is a notation comes from lambda calculus, where functions
are defined like this:</p>
<p><span class="math display">\[
\lambda(x).1/sqrt(x)
\]</span></p>
<p>which is equivalent to <span class="math inline">\(f(x) = 1/sqrt(x)\)</span>. You can use <code>\(x)</code> or <code>function(x)</code> interchangeably.</p>
<p>You now know a lot about writing your own functions. In the next chapter, we are going to learn
about functional programming, the programming paradigm I described in the introduction of this
book.</p>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Exercises<a href="defining-your-own-functions.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-1-5" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1<a href="defining-your-own-functions.html#exercise-1-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Create the following vector:</li>
</ul>
<p><span class="math display">\[a = (1,6,7,8,8,9,2)\]</span></p>
<p>Using a for loop and a while loop, compute the sum of its elements. To avoid issues, use <code>i</code>
as the counter inside the for loop, and <code>j</code> as the counter for the while loop.</p>
<ul>
<li>How would you achieve that with a functional (a function that takes a function as an argument)?</li>
</ul>
</div>
<div id="exercise-2-3" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2<a href="defining-your-own-functions.html#exercise-2-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let’s use a loop to get the matrix product of a matrix A and B. Follow these steps to create the loop:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Create matrix A:</li>
</ol>
<p><span class="math display">\[A = \left(
  \begin{array}{ccc}
   9 &amp; 4 &amp; 12 \\
   5 &amp; 0 &amp; 7 \\
   2 &amp; 6 &amp; 8 \\
   9 &amp; 2 &amp; 9
  \end{array} \right)
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Create matrix B:</li>
</ol>
<p><span class="math display">\[B = \left(
\begin{array}{cccc}
5 &amp; 4 &amp; 2 &amp; 5 \\
2 &amp; 7 &amp; 2 &amp; 1 \\
8 &amp; 3 &amp; 2 &amp; 6 \\
\end{array} \right)
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Create a matrix C, with dimension 4x4 that will hold the result. Use this command: `C = matrix(rep(0,16), nrow = 4)}</p></li>
<li><p>Using a for loop, loop over the rows of A first: `for(i in 1:nrow(A))}</p></li>
<li><p>Inside this loop, loop over the columns of B: `for(j in 1:ncol(B))}</p></li>
<li><p>Again, inside this loop, loop over the rows of B: `for(k in 1:nrow(B))}</p></li>
<li><p>Inside this last loop, compute the result and save it inside C: `C[i,j] = C[i,j] + A[i,k] * B[k,j]}</p></li>
<li><p>Now write a function that takes two matrices as arguments, and returns their product.</p></li>
</ol>
<ul>
<li>R has a built-in function to compute the dot product of 2 matrices. Which is it?</li>
</ul>
</div>
<div id="exercise-3-3" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3<a href="defining-your-own-functions.html#exercise-3-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Fizz Buzz: Print integers from 1 to 100. If a number is divisible by 3, print the word <code>"Fizz"</code> if
it’s divisible by 5, print <code>"Buzz"</code>. Use a for loop and if statements.</p></li>
<li><p>Write a function that takes an integer as arguments, and prints <code>"Fizz"</code> or <code>"Buzz"</code> up to that integer.</p></li>
</ul>
</div>
<div id="exercise-4-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4<a href="defining-your-own-functions.html#exercise-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Fizz Buzz 2: Same as above, but now add this third condition: if a number is both divisible by 3 and 5, print <code>"FizzBuzz"</code>.</p></li>
<li><p>Write a function that takes an integer as argument, and prints <code>Fizz</code>, <code>Buzz</code> or <code>FizzBuzz</code> up to that integer.</p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functional-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
