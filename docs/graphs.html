<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Graphs | Modern R with the tidyverse</title>
  <meta name="description" content="This book will teach you how to use R to solve your statistical, data science and machine learning problems. Importing data, computing descriptive statistics, running regressions (or more complex machine learning models) and generating reports are some of the topics covered. No previous experience with R is needed." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Graphs | Modern R with the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book will teach you how to use R to solve your statistical, data science and machine learning problems. Importing data, computing descriptive statistics, running regressions (or more complex machine learning models) and generating reports are some of the topics covered. No previous experience with R is needed." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Graphs | Modern R with the tidyverse" />
  
  <meta name="twitter:description" content="This book will teach you how to use R to solve your statistical, data science and machine learning problems. Importing data, computing descriptive statistics, running regressions (or more complex machine learning models) and generating reports are some of the topics covered. No previous experience with R is needed." />
  

<meta name="author" content="Bruno Rodrigues" />


<meta name="date" content="2022-06-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descriptive-statistics-and-data-manipulation.html"/>
<link rel="next" href="statistical-models.html"/>
<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modern R with the tidyverse</a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a>
<ul>
<li><a href="index.html#note-to-the-reader">Note to the reader<span></span></a></li>
<li><a href="index.html#what-is-r">What is R?<span></span></a></li>
<li><a href="index.html#who-is-this-book-for">Who is this book for?<span></span></a></li>
<li><a href="index.html#why-this-book">Why this book?<span></span></a></li>
<li><a href="index.html#why-modern-r">Why <em>modern</em> R?<span></span></a></li>
<li><a href="index.html#what-is-rstudio">What is RStudio?<span></span></a></li>
<li><a href="index.html#what-to-expect-from-this-book">What to expect from this book?<span></span></a></li>
<li><a href="index.html#prerequisites">Prerequisites<span></span></a></li>
<li><a href="index.html#what-are-packages">What are packages?<span></span></a></li>
<li><a href="index.html#the-author">The author<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting to know RStudio<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#panes"><i class="fa fa-check"></i><b>1.1</b> Panes<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#console"><i class="fa fa-check"></i><b>1.2</b> Console<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#scripts"><i class="fa fa-check"></i><b>1.3</b> Scripts<span></span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#the-help-pane"><i class="fa fa-check"></i><b>1.3.1</b> The help pane<span></span></a></li>
<li class="chapter" data-level="1.3.2" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#the-environment-pane"><i class="fa fa-check"></i><b>1.3.2</b> The Environment pane<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#options"><i class="fa fa-check"></i><b>1.4</b> Options<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>1.5</b> Keyboard shortcuts<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#projects"><i class="fa fa-check"></i><b>1.6</b> Projects<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#history"><i class="fa fa-check"></i><b>1.7</b> History<span></span></a></li>
<li class="chapter" data-level="1.8" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#plots"><i class="fa fa-check"></i><b>1.8</b> Plots<span></span></a></li>
<li class="chapter" data-level="1.9" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#addins"><i class="fa fa-check"></i><b>1.9</b> Addins<span></span></a></li>
<li class="chapter" data-level="1.10" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#packages"><i class="fa fa-check"></i><b>1.10</b> Packages<span></span></a></li>
<li class="chapter" data-level="1.11" data-path="getting-to-know-rstudio.html"><a href="getting-to-know-rstudio.html#exercises"><i class="fa fa-check"></i><b>1.11</b> Exercises<span></span></a>
<ul>
<li><a href="getting-to-know-rstudio.html#exercise-1">Exercise 1<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><i class="fa fa-check"></i><b>2</b> Objects, their classes and types, and useful R functions to get you started<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-numeric-class"><i class="fa fa-check"></i><b>2.1</b> The <code>numeric</code> class<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-character-class"><i class="fa fa-check"></i><b>2.2</b> The <code>character</code> class<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-factor-class"><i class="fa fa-check"></i><b>2.3</b> The <code>factor</code> class<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-date-class"><i class="fa fa-check"></i><b>2.4</b> The <code>Date</code> class<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-logical-class"><i class="fa fa-check"></i><b>2.5</b> The <code>logical</code> class<span></span></a></li>
<li class="chapter" data-level="2.6" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#vectors-and-matrices"><i class="fa fa-check"></i><b>2.6</b> Vectors and matrices<span></span></a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-c-function"><i class="fa fa-check"></i><b>2.6.1</b> The <code>c()</code> function<span></span></a></li>
<li class="chapter" data-level="2.6.2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#cbind-and-rbind"><i class="fa fa-check"></i><b>2.6.2</b> <code>cbind()</code> and <code>rbind()</code><span></span></a></li>
<li class="chapter" data-level="2.6.3" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-matrix-class"><i class="fa fa-check"></i><b>2.6.3</b> The <code>matrix</code> class<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-list-class"><i class="fa fa-check"></i><b>2.7</b> The <code>list</code> class<span></span></a></li>
<li class="chapter" data-level="2.8" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#the-data.frame-and-tibble-classes"><i class="fa fa-check"></i><b>2.8</b> The <code>data.frame</code> and <code>tibble</code> classes<span></span></a></li>
<li class="chapter" data-level="2.9" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#formulas"><i class="fa fa-check"></i><b>2.9</b> Formulas<span></span></a></li>
<li class="chapter" data-level="2.10" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#models"><i class="fa fa-check"></i><b>2.10</b> Models<span></span></a></li>
<li class="chapter" data-level="2.11" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#null-na-and-nan"><i class="fa fa-check"></i><b>2.11</b> NULL, NA and NaN<span></span></a></li>
<li class="chapter" data-level="2.12" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#useful-functions-to-get-you-started"><i class="fa fa-check"></i><b>2.12</b> Useful functions to get you started<span></span></a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#sequences"><i class="fa fa-check"></i><b>2.12.1</b> Sequences<span></span></a></li>
<li class="chapter" data-level="2.12.2" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#basic-string-manipulation"><i class="fa fa-check"></i><b>2.12.2</b> Basic string manipulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html"><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercises-1"><i class="fa fa-check"></i><b>2.13</b> Exercises<span></span></a>
<ul>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-1-1">Exercise 1<span></span></a></li>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-2">Exercise 2<span></span></a></li>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-3">Exercise 3<span></span></a></li>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-4">Exercise 4<span></span></a></li>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-5">Exercise 5<span></span></a></li>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-6">Exercise 6<span></span></a></li>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-7">Exercise 7<span></span></a></li>
<li><a href="objects-their-classes-and-types-and-useful-r-functions-to-get-you-started.html#exercise-8">Exercise 8<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>3</b> Reading and writing data<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#the-swiss-army-knife-of-data-import-and-export-rio"><i class="fa fa-check"></i><b>3.1</b> The swiss army knife of data import and export: <code>{rio}</code><span></span></a></li>
<li class="chapter" data-level="3.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-any-object-to-disk"><i class="fa fa-check"></i><b>3.2</b> Writing any object to disk<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#using-rstudio-projects-to-manage-paths"><i class="fa fa-check"></i><b>3.3</b> Using RStudio projects to manage paths<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Descriptive statistics and data manipulation<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#a-data-exploration-exercice-using-base-r"><i class="fa fa-check"></i><b>4.1</b> A data exploration exercice using <em>base</em> R<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#smoking-is-bad-for-you-but-pipes-are-your-friend"><i class="fa fa-check"></i><b>4.2</b> Smoking is bad for you, but pipes are your friend<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#the-tidyverses-enfant-prodige-dplyr"><i class="fa fa-check"></i><b>4.3</b> The <code>{tidyverse}</code>’s <em>enfant prodige</em>: <code>{dplyr}</code><span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#a-first-taste-of-data-manipulation-with-dplyr"><i class="fa fa-check"></i><b>4.3.1</b> A first taste of data manipulation with <code>{dplyr}</code><span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#filter-the-rows-of-a-dataset-with-filter"><i class="fa fa-check"></i><b>4.3.2</b> Filter the rows of a dataset with <code>filter()</code><span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#select-columns-with-select"><i class="fa fa-check"></i><b>4.3.3</b> Select columns with <code>select()</code><span></span></a></li>
<li class="chapter" data-level="4.3.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#group-the-observations-of-your-dataset-with-group_by"><i class="fa fa-check"></i><b>4.3.4</b> Group the observations of your dataset with <code>group_by()</code><span></span></a></li>
<li class="chapter" data-level="4.3.5" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#get-summary-statistics-with-summarise"><i class="fa fa-check"></i><b>4.3.5</b> Get summary statistics with <code>summarise()</code><span></span></a></li>
<li class="chapter" data-level="4.3.6" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#adding-columns-with-mutate-and-transmute"><i class="fa fa-check"></i><b>4.3.6</b> Adding columns with <code>mutate()</code> and <code>transmute()</code><span></span></a></li>
<li class="chapter" data-level="4.3.7" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#joining-tibbles-with-full_join-left_join-right_join-and-all-the-others"><i class="fa fa-check"></i><b>4.3.7</b> Joining <code>tibble</code>s with <code>full_join()</code>, <code>left_join()</code>, <code>right_join()</code> and all the others<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#reshaping-and-sprucing-up-data-with-tidyr"><i class="fa fa-check"></i><b>4.4</b> Reshaping and sprucing up data with <code>{tidyr}</code><span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#pivot_wider-and-pivot_longer"><i class="fa fa-check"></i><b>4.4.1</b> <code>pivot_wider()</code> and <code>pivot_longer()</code><span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#fill-and-full_seq"><i class="fa fa-check"></i><b>4.4.2</b> <code>fill()</code> and <code>full_seq()</code><span></span></a></li>
<li class="chapter" data-level="4.4.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#put-order-in-your-columns-with-separate-unite-and-in-your-rows-with-separate_rows"><i class="fa fa-check"></i><b>4.4.3</b> Put order in your columns with <code>separate()</code>, <code>unite()</code>, and in your rows with <code>separate_rows()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#working-on-many-columns-with-across"><i class="fa fa-check"></i><b>4.5</b> Working on many columns with <code>across()</code><span></span></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#filter-and-across"><i class="fa fa-check"></i><b>4.5.1</b> <code>filter()</code> and <code>across()</code><span></span></a></li>
<li class="chapter" data-level="4.5.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#selecting-and-renaming-with-across"><i class="fa fa-check"></i><b>4.5.2</b> Selecting and renaming with <code>across()</code><span></span></a></li>
<li class="chapter" data-level="4.5.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#group_by-and-across"><i class="fa fa-check"></i><b>4.5.3</b> <code>group_by()</code> and <code>across()</code><span></span></a></li>
<li class="chapter" data-level="4.5.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#summarise-across-many-columns"><i class="fa fa-check"></i><b>4.5.4</b> <code>summarise()</code> across many columns<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#other-useful-tidyverse-functions"><i class="fa fa-check"></i><b>4.6</b> Other useful <code>{tidyverse}</code> functions<span></span></a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#if_else-case_when-and-recode"><i class="fa fa-check"></i><b>4.6.1</b> <code>if_else()</code>, <code>case_when()</code> and <code>recode()</code><span></span></a></li>
<li class="chapter" data-level="4.6.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#lead-and-lag"><i class="fa fa-check"></i><b>4.6.2</b> <code>lead()</code> and <code>lag()</code><span></span></a></li>
<li class="chapter" data-level="4.6.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#ntile"><i class="fa fa-check"></i><b>4.6.3</b> <code>ntile()</code><span></span></a></li>
<li class="chapter" data-level="4.6.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#arrange"><i class="fa fa-check"></i><b>4.6.4</b> <code>arrange()</code><span></span></a></li>
<li class="chapter" data-level="4.6.5" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#tally-and-count"><i class="fa fa-check"></i><b>4.6.5</b> <code>tally()</code> and <code>count()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#special-packages-for-special-kinds-of-data-forcats-lubridate-and-stringr"><i class="fa fa-check"></i><b>4.7</b> Special packages for special kinds of data: <code>{forcats}</code>, <code>{lubridate}</code>, and <code>{stringr}</code><span></span></a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#section"><i class="fa fa-check"></i><b>4.7.1</b> 🐱🐱🐱🐱<span></span></a></li>
<li class="chapter" data-level="4.7.2" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#get-your-dates-right-with-lubridate"><i class="fa fa-check"></i><b>4.7.2</b> Get your dates right with <code>{lubridate}</code><span></span></a></li>
<li class="chapter" data-level="4.7.3" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#manipulate-strings-with-stringr"><i class="fa fa-check"></i><b>4.7.3</b> Manipulate strings with <code>{stringr}</code><span></span></a></li>
<li class="chapter" data-level="4.7.4" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#tidy-data-frames-with-tibble"><i class="fa fa-check"></i><b>4.7.4</b> Tidy data frames with <code>{tibble}</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#list-columns"><i class="fa fa-check"></i><b>4.8</b> List-columns<span></span></a></li>
<li class="chapter" data-level="4.9" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#going-beyond-descriptive-statistics-and-data-manipulation"><i class="fa fa-check"></i><b>4.9</b> Going beyond descriptive statistics and data manipulation<span></span></a></li>
<li class="chapter" data-level="4.10" data-path="descriptive-statistics-and-data-manipulation.html"><a href="descriptive-statistics-and-data-manipulation.html#exercises-2"><i class="fa fa-check"></i><b>4.10</b> Exercises<span></span></a>
<ul>
<li><a href="descriptive-statistics-and-data-manipulation.html#exercise-1-2">Exercise 1<span></span></a></li>
<li><a href="descriptive-statistics-and-data-manipulation.html#exercise-2-1">Exercise 2<span></span></a></li>
<li><a href="descriptive-statistics-and-data-manipulation.html#exercise-3-1">Exercise 3<span></span></a></li>
<li><a href="descriptive-statistics-and-data-manipulation.html#exercise-4-1">Exercise 4<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>5</b> Graphs<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="graphs.html"><a href="graphs.html#resources"><i class="fa fa-check"></i><b>5.1</b> Resources<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="graphs.html"><a href="graphs.html#examples"><i class="fa fa-check"></i><b>5.2</b> Examples<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="graphs.html"><a href="graphs.html#barplots"><i class="fa fa-check"></i><b>5.2.1</b> Barplots<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="graphs.html"><a href="graphs.html#scatter-plots"><i class="fa fa-check"></i><b>5.2.2</b> Scatter plots<span></span></a></li>
<li class="chapter" data-level="5.2.3" data-path="graphs.html"><a href="graphs.html#density"><i class="fa fa-check"></i><b>5.2.3</b> Density<span></span></a></li>
<li class="chapter" data-level="5.2.4" data-path="graphs.html"><a href="graphs.html#line-plots"><i class="fa fa-check"></i><b>5.2.4</b> Line plots<span></span></a></li>
<li class="chapter" data-level="5.2.5" data-path="graphs.html"><a href="graphs.html#facets"><i class="fa fa-check"></i><b>5.2.5</b> Facets<span></span></a></li>
<li class="chapter" data-level="5.2.6" data-path="graphs.html"><a href="graphs.html#pie-charts"><i class="fa fa-check"></i><b>5.2.6</b> Pie Charts<span></span></a></li>
<li class="chapter" data-level="5.2.7" data-path="graphs.html"><a href="graphs.html#adding-text-to-plots"><i class="fa fa-check"></i><b>5.2.7</b> Adding text to plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="graphs.html"><a href="graphs.html#customization"><i class="fa fa-check"></i><b>5.3</b> Customization<span></span></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="graphs.html"><a href="graphs.html#changing-titles-axes-labels-options-mixing-geoms-and-changing-themes"><i class="fa fa-check"></i><b>5.3.1</b> Changing titles, axes labels, options, mixing geoms and changing themes<span></span></a></li>
<li class="chapter" data-level="5.3.2" data-path="graphs.html"><a href="graphs.html#colour-schemes"><i class="fa fa-check"></i><b>5.3.2</b> Colour schemes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="graphs.html"><a href="graphs.html#saving-plots-to-disk"><i class="fa fa-check"></i><b>5.4</b> Saving plots to disk<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="graphs.html"><a href="graphs.html#exercises-3"><i class="fa fa-check"></i><b>5.5</b> Exercises<span></span></a>
<ul>
<li><a href="graphs.html#exercise-1-3">Exercise 1<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-models.html"><a href="statistical-models.html"><i class="fa fa-check"></i><b>6</b> Statistical models<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-models.html"><a href="statistical-models.html#terminology"><i class="fa fa-check"></i><b>6.1</b> Terminology<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="statistical-models.html"><a href="statistical-models.html#fitting-a-model-to-data"><i class="fa fa-check"></i><b>6.2</b> Fitting a model to data<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="statistical-models.html"><a href="statistical-models.html#diagnostics"><i class="fa fa-check"></i><b>6.3</b> Diagnostics<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="statistical-models.html"><a href="statistical-models.html#interpreting-models"><i class="fa fa-check"></i><b>6.4</b> Interpreting models<span></span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="statistical-models.html"><a href="statistical-models.html#marginal-effects"><i class="fa fa-check"></i><b>6.4.1</b> Marginal effects<span></span></a></li>
<li class="chapter" data-level="6.4.2" data-path="statistical-models.html"><a href="statistical-models.html#explainability-of-black-box-models"><i class="fa fa-check"></i><b>6.4.2</b> Explainability of <em>black-box</em> models<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="statistical-models.html"><a href="statistical-models.html#comparing-models"><i class="fa fa-check"></i><b>6.5</b> Comparing models<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="statistical-models.html"><a href="statistical-models.html#using-a-model-for-prediction"><i class="fa fa-check"></i><b>6.6</b> Using a model for prediction<span></span></a></li>
<li class="chapter" data-level="6.7" data-path="statistical-models.html"><a href="statistical-models.html#beyond-linear-regression"><i class="fa fa-check"></i><b>6.7</b> Beyond linear regression<span></span></a></li>
<li class="chapter" data-level="6.8" data-path="statistical-models.html"><a href="statistical-models.html#hyper-parameters"><i class="fa fa-check"></i><b>6.8</b> Hyper-parameters<span></span></a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="statistical-models.html"><a href="statistical-models.html#ridge-regression"><i class="fa fa-check"></i><b>6.8.1</b> Ridge regression<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="statistical-models.html"><a href="statistical-models.html#training-validating-and-testing-models"><i class="fa fa-check"></i><b>6.9</b> Training, validating, and testing models<span></span></a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="statistical-models.html"><a href="statistical-models.html#set-up"><i class="fa fa-check"></i><b>6.9.1</b> Set up<span></span></a></li>
<li class="chapter" data-level="6.9.2" data-path="statistical-models.html"><a href="statistical-models.html#bayesian-hyperparameter-optimization"><i class="fa fa-check"></i><b>6.9.2</b> Bayesian hyperparameter optimization<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html"><i class="fa fa-check"></i><b>7</b> Defining your own functions<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#control-flow"><i class="fa fa-check"></i><b>7.1</b> Control flow<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#if-else"><i class="fa fa-check"></i><b>7.1.1</b> If-else<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#for-loops"><i class="fa fa-check"></i><b>7.1.2</b> For loops<span></span></a></li>
<li class="chapter" data-level="7.1.3" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#while-loops"><i class="fa fa-check"></i><b>7.1.3</b> While loops<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#writing-your-own-functions"><i class="fa fa-check"></i><b>7.2</b> Writing your own functions<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#declaring-functions-in-r"><i class="fa fa-check"></i><b>7.2.1</b> Declaring functions in R<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#fibonacci-numbers"><i class="fa fa-check"></i><b>7.2.2</b> Fibonacci numbers<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercises-4"><i class="fa fa-check"></i><b>7.3</b> Exercises<span></span></a>
<ul>
<li><a href="defining-your-own-functions.html#exercise-1-4">Exercise 1<span></span></a></li>
<li><a href="defining-your-own-functions.html#exercise-2-2">Exercise 2<span></span></a></li>
<li><a href="defining-your-own-functions.html#exercise-3-2">Exercise 3<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-take-functions-as-arguments-writing-your-own-higher-order-functions"><i class="fa fa-check"></i><b>7.4</b> Functions that take functions as arguments: writing your own higher-order functions<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-return-functions"><i class="fa fa-check"></i><b>7.5</b> Functions that return functions<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-take-columns-of-data-as-arguments"><i class="fa fa-check"></i><b>7.6</b> Functions that take columns of data as arguments<span></span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#the-enquo---approach"><i class="fa fa-check"></i><b>7.6.1</b> The <code>enquo() - !!()</code> approach<span></span></a></li>
<li class="chapter" data-level="7.6.2" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#curly-curly-a-simplified-approach-to-the-enquo-and-framework"><i class="fa fa-check"></i><b>7.6.2</b> Curly Curly, a simplified approach to the <code>enquo()</code> and <code>!!()</code> framework<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#functions-that-use-loops"><i class="fa fa-check"></i><b>7.7</b> Functions that use loops<span></span></a></li>
<li class="chapter" data-level="7.8" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#anonymous-functions"><i class="fa fa-check"></i><b>7.8</b> Anonymous functions<span></span></a></li>
<li class="chapter" data-level="7.9" data-path="defining-your-own-functions.html"><a href="defining-your-own-functions.html#exercises-5"><i class="fa fa-check"></i><b>7.9</b> Exercises<span></span></a>
<ul>
<li><a href="defining-your-own-functions.html#exercise-1-5">Exercise 1<span></span></a></li>
<li><a href="defining-your-own-functions.html#exercise-2-3">Exercise 2<span></span></a></li>
<li><a href="defining-your-own-functions.html#exercise-3-3">Exercise 3<span></span></a></li>
<li><a href="defining-your-own-functions.html#exercise-4-2">Exercise 4<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="functional-programming.html"><a href="functional-programming.html"><i class="fa fa-check"></i><b>8</b> Functional programming<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="functional-programming.html"><a href="functional-programming.html#function-definitions"><i class="fa fa-check"></i><b>8.1</b> Function definitions<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="functional-programming.html"><a href="functional-programming.html#properties-of-functions"><i class="fa fa-check"></i><b>8.2</b> Properties of functions<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="functional-programming.html"><a href="functional-programming.html#functional-programming-with-purrr"><i class="fa fa-check"></i><b>8.3</b> Functional programming with <code>{purrr}</code><span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="functional-programming.html"><a href="functional-programming.html#doing-away-with-loops-the-map-family-of-functions"><i class="fa fa-check"></i><b>8.3.1</b> Doing away with loops: the <code>map*()</code> family of functions<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="functional-programming.html"><a href="functional-programming.html#reducing-with-purrr"><i class="fa fa-check"></i><b>8.3.2</b> Reducing with <code>purrr</code><span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="functional-programming.html"><a href="functional-programming.html#error-handling-with-safely-and-possibly"><i class="fa fa-check"></i><b>8.3.3</b> Error handling with <code>safely()</code> and <code>possibly()</code><span></span></a></li>
<li class="chapter" data-level="8.3.4" data-path="functional-programming.html"><a href="functional-programming.html#partial-applications-with-partial"><i class="fa fa-check"></i><b>8.3.4</b> Partial applications with <code>partial()</code><span></span></a></li>
<li class="chapter" data-level="8.3.5" data-path="functional-programming.html"><a href="functional-programming.html#function-composition-using-compose"><i class="fa fa-check"></i><b>8.3.5</b> Function composition using <code>compose</code><span></span></a></li>
<li class="chapter" data-level="8.3.6" data-path="functional-programming.html"><a href="functional-programming.html#transposing-lists"><i class="fa fa-check"></i><b>8.3.6</b> «Transposing lists»<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="functional-programming.html"><a href="functional-programming.html#list-based-workflows-for-efficiency"><i class="fa fa-check"></i><b>8.4</b> List-based workflows for efficiency<span></span></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="functional-programming.html"><a href="functional-programming.html#functional-programming-and-plotting"><i class="fa fa-check"></i><b>8.4.1</b> Functional programming and plotting<span></span></a></li>
<li class="chapter" data-level="8.4.2" data-path="functional-programming.html"><a href="functional-programming.html#modeling-with-functional-programming"><i class="fa fa-check"></i><b>8.4.2</b> Modeling with functional programming<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="functional-programming.html"><a href="functional-programming.html#exercises-6"><i class="fa fa-check"></i><b>8.5</b> Exercises<span></span></a>
<ul>
<li><a href="functional-programming.html#exercise-1-6">Exercise 1<span></span></a></li>
<li><a href="functional-programming.html#exercise-2-4">Exercise 2<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="package-development.html"><a href="package-development.html"><i class="fa fa-check"></i><b>9</b> Package development<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="package-development.html"><a href="package-development.html#why-you-need-to-write-your-own-package"><i class="fa fa-check"></i><b>9.1</b> Why you need to write your own package<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="package-development.html"><a href="package-development.html#starting-easy-creating-a-package-to-share-data"><i class="fa fa-check"></i><b>9.2</b> Starting easy: creating a package to share data<span></span></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="package-development.html"><a href="package-development.html#setting-up-a-github-account"><i class="fa fa-check"></i><b>9.2.1</b> Setting up a Github account<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="package-development.html"><a href="package-development.html#starting-your-package"><i class="fa fa-check"></i><b>9.2.2</b> Starting your package<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="package-development.html"><a href="package-development.html#including-data-inside-the-package"><i class="fa fa-check"></i><b>9.3</b> Including data inside the package<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="package-development.html"><a href="package-development.html#adding-functions-to-your-package"><i class="fa fa-check"></i><b>9.4</b> Adding functions to your package<span></span></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="package-development.html"><a href="package-development.html#one-function-inside-one-script"><i class="fa fa-check"></i><b>9.4.1</b> One function inside one script<span></span></a></li>
<li class="chapter" data-level="9.4.2" data-path="package-development.html"><a href="package-development.html#many-functions-inside-a-script"><i class="fa fa-check"></i><b>9.4.2</b> Many functions inside a script<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="package-development.html"><a href="package-development.html#documenting-your-package"><i class="fa fa-check"></i><b>9.5</b> Documenting your package<span></span></a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="package-development.html"><a href="package-development.html#description"><i class="fa fa-check"></i><b>9.5.1</b> Description<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="package-development.html"><a href="package-development.html#unit-testing-your-package"><i class="fa fa-check"></i><b>9.6</b> Unit testing your package<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="further-topics.html"><a href="further-topics.html"><i class="fa fa-check"></i><b>10</b> Further topics<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="further-topics.html"><a href="further-topics.html#using-python-from-r-with-reticulate"><i class="fa fa-check"></i><b>10.1</b> Using Python from R with <code>{reticulate}</code><span></span></a></li>
<li class="chapter" data-level="10.2" data-path="further-topics.html"><a href="further-topics.html#generating-pdf-or-word-reports-with-r"><i class="fa fa-check"></i><b>10.2</b> Generating Pdf or Word reports with R<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="further-topics.html"><a href="further-topics.html#scraping-the-internet"><i class="fa fa-check"></i><b>10.3</b> Scraping the internet<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="further-topics.html"><a href="further-topics.html#regular-expressions"><i class="fa fa-check"></i><b>10.4</b> Regular expressions<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="further-topics.html"><a href="further-topics.html#setting-up-a-blog-with-blogdown"><i class="fa fa-check"></i><b>10.5</b> Setting up a blog with <code>{blogdown}</code><span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern R with the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphs" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Graphs<a href="graphs.html#graphs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>By default, it is possible to make a lot of graphs with R without the need of any external
packages. However, in this chapter, we are going to learn how to make graphs using <code>{ggplot2}</code> which
is a very powerful package that produces amazing graphs. There is an entry cost to <code>{ggplot2}</code> as it
works in a very different way than what you would expect, especially if you know how to make plots
with the basic R functions already. But the resulting graphs are well worth the effort and once
you will know more about <code>{ggplot2}</code> you will see that in a lot of situations it is actually faster
and easier. Another advantage is that making plots with <code>{ggplot2}</code> is consistent, so you do not need
to learn anything specific to make, say, density plots. There are a lot of extensions to <code>{ggplot2}</code>,
such as <code>{ggridges}</code> to create so-called ridge plots and <code>{gganimate}</code> to create animated plots. By
the end of this chapter you will know how to do basic plots with <code>{ggplot2}</code> and also how to use these
two extensions.</p>
<div id="resources" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Resources<a href="graphs.html#resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before showing some examples and the general functionality of <code>{ggplot2}</code>, I list here some online
resources that I keep coming back to:</p>
<ul>
<li><p><a href="http://socviz.co/">Data Visualization for Social Science</a></p></li>
<li><p><a href="http://www.cookbook-r.com/Graphs/">R Graphics Cookbook</a></p></li>
<li><p><a href="http://www.r-graph-gallery.com/portfolio/ggplot2-package/">R graph gallery</a></p></li>
<li><p><a href="http://motioninsocial.com/tufte/">Tufte in R</a></p></li>
<li><p><a href="https://exts.ggplot2.tidyverse.org/">ggplot2 extensions</a></p></li>
<li><p><a href="https://jrnold.github.io/ggthemes/reference/index.html">ggthemes function reference</a></p></li>
<li><p><a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">ggplot2 cheatsheet</a></p></li>
</ul>
<p>When I first started using <code>{ggplot2}</code>, I had a cookbook approach to it; I tried findinge examples
online that looked like what I needed, copy and paste the code and then adapted it to my case. The above resources
are the ones I consulted and keep consulting in these situations (I also go back to past code I’ve written, of
course). Don’t hesitate to skim these resources for inspiration and to learn more about some
extensions to <code>{ggplot2}</code>. In the next subsections I am going to show you how to draw the most common
plots, as well as show you how to customize your plots with <code>{ggthemes}</code>, a package that contains pre-defined
themes for <code>{ggplot2}</code>.</p>
</div>
<div id="examples" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Examples<a href="graphs.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I think that the best way to learn how to use <code>{ggplot2}</code> is to jump right into it. Let’s first start with
barplots.</p>
<div id="barplots" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Barplots<a href="graphs.html#barplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To follow the examples below, load the following libraries:</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="graphs.html#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb716-2"><a href="graphs.html#cb716-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span></code></pre></div>
<p><code>{ggplot2}</code> is an implementation of the <em>Grammar of Graphics</em> by <span class="citation">Wilkinson (<a href="#ref-wilkinson2006" role="doc-biblioref">2006</a>)</span>, but you don’t need
to read the books to start using it. If we go back to the Star Wars data (contained in <code>dplyr</code>),
and wish to draw a barplot of the gender, the following lines are enough:</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="graphs.html#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(starwars, <span class="fu">aes</span>(gender)) <span class="sc">+</span></span>
<span id="cb717-2"><a href="graphs.html#cb717-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-423-1.png" width="672" /></p>
<p>The first argument of the function is the data (called <code>starwars</code> in this example), and then the
function <code>aes()</code>. This function is where you list the variables that you want to map to the aesthetics
of the <em>geoms</em> functions. On the second line, you see that we use the <code>geom_bar()</code> function. This
function creates a barplot of <code>gender</code> variable.
You can get different kind of plots by using different <code>geom_</code> functions. You can also provide the
<code>aes()</code> argument to the <code>geom_*()</code> function:</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="graphs.html#cb718-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(starwars) <span class="sc">+</span></span>
<span id="cb718-2"><a href="graphs.html#cb718-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(gender))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-424-1.png" width="672" /></p>
<p>The difference between these two approaches is that when you specify the aesthetics in the <code>ggplot()</code> function,
all the <code>geom_*()</code> functions that follow will inherited these aesthetics. This is useful if you want to avoid
writing the same code over and over again, but can be problematic if you need to specify different aesthetics
to different <code>geom_*()</code> functions. This will become clear in a later example.</p>
<p>You can add options to your plots, for instance, you can change the coordinate system in your barplot:</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="graphs.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(starwars, <span class="fu">aes</span>(gender)) <span class="sc">+</span></span>
<span id="cb719-2"><a href="graphs.html#cb719-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb719-3"><a href="graphs.html#cb719-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-425-1.png" width="672" /></p>
<p>This is the basic recipe to create plots using <code>{ggplot2}</code>: start with a call to <code>ggplot()</code> where you specify
the data you want to plot, and optionally the aesthetics. Then, use the <code>geom_*()</code> function you need; if you
did not specify the aesthetics in the call to the <code>ggplot()</code> function, do it here. Then, you can add different
options, such as changing the coordinate system, changing the theme, the colour palette used, changing the
position of the legend and much, much more. This chapter will only give you an overview of the capabilities
of <code>{ggplot2}</code>.</p>
</div>
<div id="scatter-plots" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Scatter plots<a href="graphs.html#scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Scatter plots are very useful, especially if you are trying to figure out the relationship between two variables.
For instance, let’s make a scatter plot of height vs weight of Star Wars characters:</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="graphs.html#cb720-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(starwars) <span class="sc">+</span></span>
<span id="cb720-2"><a href="graphs.html#cb720-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-426-1.png" width="672" /></p>
<p>As you can see there is an outlier; a very heavy character! Star Wars fans already guessed it, it’s Jabba the Hut.
To make the plot easier to read, let’s remove this outlier:</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="graphs.html#cb721-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb721-2"><a href="graphs.html#cb721-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb721-3"><a href="graphs.html#cb721-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb721-4"><a href="graphs.html#cb721-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-427-1.png" width="672" /></p>
<p>There is a positive correlation between height and mass, by adding <code>geom_smooth()</code> with the option <code>method = "lm"</code>:</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="graphs.html#cb722-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb722-2"><a href="graphs.html#cb722-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb722-3"><a href="graphs.html#cb722-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(height, mass)) <span class="sc">+</span></span>
<span id="cb722-4"><a href="graphs.html#cb722-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass)) <span class="sc">+</span></span>
<span id="cb722-5"><a href="graphs.html#cb722-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-428-1.png" width="672" /></p>
<p>I’ve moved the <code>aes(height, mass)</code> up to the <code>ggplot()</code> function because both <code>geom_point()</code> and <code>geom_smooth()</code>
need them, and as explained in the begging of this section, the aesthetics listed in <code>ggplot()</code> get passed down
to the other geoms.</p>
<p>If you omit <code>method = "lm</code>, you get a non-parametric curve:</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="graphs.html#cb724-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb724-2"><a href="graphs.html#cb724-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb724-3"><a href="graphs.html#cb724-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(height, mass)) <span class="sc">+</span></span>
<span id="cb724-4"><a href="graphs.html#cb724-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass)) <span class="sc">+</span></span>
<span id="cb724-5"><a href="graphs.html#cb724-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-429-1.png" width="672" /></p>
</div>
<div id="density" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Density<a href="graphs.html#density" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>geom_density()</code> to get density plots:</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="graphs.html#cb726-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(starwars, <span class="fu">aes</span>(height)) <span class="sc">+</span></span>
<span id="cb726-2"><a href="graphs.html#cb726-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-430-1.png" width="672" /></p>
<p>Let’s go into more detail now; what if you would like to plot the densities for feminines and masculines
only (removing the droids from the data first)? This can be done by first filtering the data using
<code>dplyr</code> and then separating the dataset by gender:</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="graphs.html#cb728-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb728-2"><a href="graphs.html#cb728-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;feminine&quot;</span>, <span class="st">&quot;masculine&quot;</span>))</span></code></pre></div>
<p>The above lines do the filtering; only keep gender if gender is in the vector <code>"feminine", "masculine"</code>.
This is much easier than having to write <code>gender == "feminine" | gender == "masculine"</code>. Then, we pipe
this dataset to <code>ggplot</code>:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="graphs.html#cb729-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb729-2"><a href="graphs.html#cb729-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;feminine&quot;</span>, <span class="st">&quot;masculine&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb729-3"><a href="graphs.html#cb729-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(height, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb729-4"><a href="graphs.html#cb729-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (stat_density).</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-432-1.png" width="672" /></p>
<p>Let’s take a closer look to the <code>aes()</code> function: I’ve added <code>fill = gender</code>. This means that
there will be one density plot for each gender in the data, and each will be coloured accordingly.
This is where <code>{ggplot2}</code> might be confusing; there is no need to write explicitly (even if it is
possible) that you want the <em>feminine</em> density to be red and the <em>masculine</em> density to be blue. You just
map the variable <code>gender</code> to this particular aesthetic. You conclude the plot by adding
<code>geom_density()</code> which is this case is the plot you want. We will see later how to change the
colours of your plot.</p>
<p>An alternative way to write this code is first to save the filtered data in a variable, and define
the aesthetics inside the <code>geom_density()</code> function:</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="graphs.html#cb731-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span></span>
<span id="cb731-2"><a href="graphs.html#cb731-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;feminine&quot;</span>, <span class="st">&quot;masculine&quot;</span>))</span>
<span id="cb731-3"><a href="graphs.html#cb731-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-4"><a href="graphs.html#cb731-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_data) <span class="sc">+</span></span>
<span id="cb731-5"><a href="graphs.html#cb731-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(height, <span class="at">fill =</span> gender))</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (stat_density).</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-433-1.png" width="672" /></p>
</div>
<div id="line-plots" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Line plots<a href="graphs.html#line-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the line plots, we are going to use official unemployment data (the same as in the previous
chapter, but with all the available years). Get it from
<a href="https://github.com/b-rodrigues/modern_R/tree/master/datasets/unemployment/all">here</a>
(downloaded from the website of the <a href="https://lustat.statec.lu/vis?pg=0&amp;df%5Bds%5D=release&amp;df%5Bid%5D=DF_X026&amp;df%5Bag%5D=LU1&amp;df%5Bvs%5D=1.0&amp;pd=2021%2C&amp;dq=..A&amp;ly%5Brw%5D=SPECIFICATION&amp;ly%5Bcl%5D=VARIABLE&amp;lc=en">Luxembourguish national statistical institute</a>.</p>
<p>Let’s plot the unemployment for the canton of Luxembourg only:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="graphs.html#cb733-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;datasets/unemployment/all/unemployment_lux_all.csv&quot;</span>)</span>
<span id="cb733-2"><a href="graphs.html#cb733-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-3"><a href="graphs.html#cb733-3" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb733-4"><a href="graphs.html#cb733-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">==</span> <span class="st">&quot;Luxembourg&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb733-5"><a href="graphs.html#cb733-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> unemployment_rate_in_percent, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb733-6"><a href="graphs.html#cb733-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-434-1.png" width="672" /></p>
<p>Because line plots are 2D, you need to specify the y and x axes. There is also another option you
need to add, <code>group = 1</code>. This is to tell <code>aes()</code> that the dots have to be connected with a single
line. What if you want to plot more than one commune?</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="graphs.html#cb734-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb734-2"><a href="graphs.html#cb734-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb734-3"><a href="graphs.html#cb734-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb734-4"><a href="graphs.html#cb734-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-435-1.png" width="672" /></p>
<p>This time, I’ve specified <code>group = division</code> which means that there has to be one line per as many
communes as in the variable <code>division</code>. I do the same for colours. I think the next example
illustrates how <code>{ggplot2}</code> is actually brilliant; if you need to add a third commune, there is no
need to specify anything else; no need to add anything to the legend, no need to specify a third
colour etc:</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="graphs.html#cb735-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb735-2"><a href="graphs.html#cb735-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb735-3"><a href="graphs.html#cb735-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb735-4"><a href="graphs.html#cb735-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-436-1.png" width="672" /></p>
<p>The three communes get mapped to the colour aesthetic so whatever the number of communes, as long
as there are enough colours, the communes will each get mapped to one of these colours.</p>
</div>
<div id="facets" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Facets<a href="graphs.html#facets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some case you have a factor variable that separates the data you wish to plot into different
categories. If you want to have a plot per category you can use the <code>facet_grid()</code> function.
Careful though, this function does not take a variable as an argument, but a formula, hence the <code>~</code>
symbol in the code below:</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="graphs.html#cb736-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb736-2"><a href="graphs.html#cb736-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">human =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">&quot;Human&quot;</span> <span class="sc">~</span> <span class="st">&quot;Human&quot;</span>,</span>
<span id="cb736-3"><a href="graphs.html#cb736-3" aria-hidden="true" tabindex="-1"></a>                           species <span class="sc">!=</span> <span class="st">&quot;Human&quot;</span> <span class="sc">~</span> <span class="st">&quot;Not Human&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb736-4"><a href="graphs.html#cb736-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;feminine&quot;</span>, <span class="st">&quot;masculine&quot;</span>), <span class="sc">!</span><span class="fu">is.na</span>(human)) <span class="sc">%&gt;%</span></span>
<span id="cb736-5"><a href="graphs.html#cb736-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(height, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb736-6"><a href="graphs.html#cb736-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> human) <span class="sc">+</span> <span class="co">#&lt;--- this is a formula</span></span>
<span id="cb736-7"><a href="graphs.html#cb736-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (stat_density).</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-437-1.png" width="672" /></p>
<p>I first created a factor variable that specifies if a Star Wars character is human or not, and then
use it for facetting. By changing the formula, you change how the facetting is done:</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="graphs.html#cb738-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb738-2"><a href="graphs.html#cb738-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">human =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">&quot;Human&quot;</span> <span class="sc">~</span> <span class="st">&quot;Human&quot;</span>,</span>
<span id="cb738-3"><a href="graphs.html#cb738-3" aria-hidden="true" tabindex="-1"></a>                           species <span class="sc">!=</span> <span class="st">&quot;Human&quot;</span> <span class="sc">~</span> <span class="st">&quot;Not Human&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb738-4"><a href="graphs.html#cb738-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;feminine&quot;</span>, <span class="st">&quot;masculine&quot;</span>), <span class="sc">!</span><span class="fu">is.na</span>(human)) <span class="sc">%&gt;%</span></span>
<span id="cb738-5"><a href="graphs.html#cb738-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(height, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb738-6"><a href="graphs.html#cb738-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(human <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb738-7"><a href="graphs.html#cb738-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (stat_density).</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-438-1.png" width="672" /></p>
<p>Recall the categorical variable <code>more_1</code> that we computed in the previous chapter? Let’s use it as
a faceting variable:</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="graphs.html#cb740-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb740-2"><a href="graphs.html#cb740-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb740-3"><a href="graphs.html#cb740-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_films =</span> <span class="fu">length</span>(films)) <span class="sc">%&gt;%</span></span>
<span id="cb740-4"><a href="graphs.html#cb740-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">more_1 =</span> <span class="fu">case_when</span>(n_films <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;Exactly one movie&quot;</span>,</span>
<span id="cb740-5"><a href="graphs.html#cb740-5" aria-hidden="true" tabindex="-1"></a>                            n_films <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;More than 1 movie&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb740-6"><a href="graphs.html#cb740-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">human =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">&quot;Human&quot;</span> <span class="sc">~</span> <span class="st">&quot;Human&quot;</span>,</span>
<span id="cb740-7"><a href="graphs.html#cb740-7" aria-hidden="true" tabindex="-1"></a>                           species <span class="sc">!=</span> <span class="st">&quot;Human&quot;</span> <span class="sc">~</span> <span class="st">&quot;Not Human&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb740-8"><a href="graphs.html#cb740-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;feminine&quot;</span>, <span class="st">&quot;masculine&quot;</span>), <span class="sc">!</span><span class="fu">is.na</span>(human)) <span class="sc">%&gt;%</span></span>
<span id="cb740-9"><a href="graphs.html#cb740-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(height, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb740-10"><a href="graphs.html#cb740-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(human <span class="sc">~</span> more_1) <span class="sc">+</span></span>
<span id="cb740-11"><a href="graphs.html#cb740-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing non-finite values (stat_density).</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-439-1.png" width="672" /></p>
</div>
<div id="pie-charts" class="section level3 hasAnchor" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> Pie Charts<a href="graphs.html#pie-charts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I am not a huge fan of pie charts, but sometimes this is what you have to do. So let’s see how you
can create pie charts.
First, let’s create a mock dataset with the function <code>tibble::tribble()</code> which allows you to create a
dataset line by line:</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="graphs.html#cb742-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb742-2"><a href="graphs.html#cb742-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>id, <span class="sc">~</span>var1, <span class="sc">~</span>var2,  <span class="sc">~</span>var3, <span class="sc">~</span>var4, <span class="sc">~</span>var5,</span>
<span id="cb742-3"><a href="graphs.html#cb742-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;a&quot;</span>, <span class="fl">26.5</span>, <span class="dv">38</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">34</span>,</span>
<span id="cb742-4"><a href="graphs.html#cb742-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">28</span>, <span class="dv">32</span>, <span class="dv">30</span>,</span>
<span id="cb742-5"><a href="graphs.html#cb742-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;c&quot;</span>, <span class="dv">34</span>, <span class="dv">32</span>, <span class="dv">30</span>, <span class="dv">28</span>, <span class="fl">26.5</span></span>
<span id="cb742-6"><a href="graphs.html#cb742-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>This data is not in the right format though, which is wide. We need to have it in the long format
for it to work with <code>{ggplot2}</code>. For this, let’s use <code>tidyr::gather()</code> as seen in the previous chapter:</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="graphs.html#cb743-1" aria-hidden="true" tabindex="-1"></a>test_data_long <span class="ot">=</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb743-2"><a href="graphs.html#cb743-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(variable, value, <span class="fu">starts_with</span>(<span class="st">&quot;var&quot;</span>))</span></code></pre></div>
<p>Now, let’s plot this data, first by creating 3 bar plots:</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="graphs.html#cb744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb744-2"><a href="graphs.html#cb744-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb744-3"><a href="graphs.html#cb744-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(variable, value, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-442-1.png" width="672" /></p>
<p>In the code above, I introduce a new option, called <code>stat = "identity"</code>. By default, <code>geom_bar()</code> counts
the number of observations of each category that is plotted, which is a statistical transformation.
By adding <code>stat = "identity"</code>, I force the statistical transformation to be the identity function, and
thus plot the data as is.</p>
<p>To create the pie chart, first we need to compute the share of each <code>id</code> to <code>var1</code>, <code>var2</code>, etc…</p>
<p>To do this, we first group by <code>id</code>, then compute the total. Then we use a new function <code>ungroup()</code>.
After using <code>ungroup()</code> all the computations are done on the whole dataset instead of by group, which
is what we need to compute the share:</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="graphs.html#cb745-1" aria-hidden="true" tabindex="-1"></a>test_data_long <span class="ot">&lt;-</span> test_data_long <span class="sc">%&gt;%</span></span>
<span id="cb745-2"><a href="graphs.html#cb745-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb745-3"><a href="graphs.html#cb745-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb745-4"><a href="graphs.html#cb745-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb745-5"><a href="graphs.html#cb745-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">share =</span> value<span class="sc">/</span>total)</span></code></pre></div>
<p>Let’s take a look to see if this is what we wanted:</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="graphs.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_data_long)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 5
##    id    variable value total share
##    &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 a     var1      26.5  160. 0.165
##  2 b     var1      30    150  0.2  
##  3 c     var1      34    150. 0.226
##  4 a     var2      38    160. 0.237
##  5 b     var2      30    150  0.2  
##  6 c     var2      32    150. 0.213
##  7 a     var3      30    160. 0.187
##  8 b     var3      28    150  0.187
##  9 c     var3      30    150. 0.199
## 10 a     var4      32    160. 0.199
## 11 b     var4      32    150  0.213
## 12 c     var4      28    150. 0.186
## 13 a     var5      34    160. 0.212
## 14 b     var5      30    150  0.2  
## 15 c     var5      26.5  150. 0.176</code></pre>
<p>If you didn’t understand what <code>ungroup()</code> did, rerun the last few lines with it and inspect the
output.</p>
<p>To plot the pie chart, we create a barplot again, but specify polar coordinates:</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="graphs.html#cb748-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb748-2"><a href="graphs.html#cb748-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb748-3"><a href="graphs.html#cb748-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> share, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb748-4"><a href="graphs.html#cb748-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>() <span class="sc">+</span></span>
<span id="cb748-5"><a href="graphs.html#cb748-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-445-1.png" width="672" /></p>
<p>As you can see, this typical pie chart is not very easy to read; compared to the barplots above it
is not easy to distinguish if <code>a</code> has a higher share than <code>b</code> or <code>c</code>. You can change the look of the
pie chart, for example by specifying <code>variable</code> as the <code>x</code>:</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="graphs.html#cb749-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb749-2"><a href="graphs.html#cb749-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb749-3"><a href="graphs.html#cb749-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> share, <span class="at">x =</span> variable, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb749-4"><a href="graphs.html#cb749-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>() <span class="sc">+</span></span>
<span id="cb749-5"><a href="graphs.html#cb749-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;x&quot;</span>, <span class="at">start =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-446-1.png" width="672" /></p>
<p>But as a general rule, avoid pie charts if possible. I find that pie charts are only interesting if
you need to show proportions that are hugely unequal, to really emphasize the difference between
said proportions.</p>
</div>
<div id="adding-text-to-plots" class="section level3 hasAnchor" number="5.2.7">
<h3><span class="header-section-number">5.2.7</span> Adding text to plots<a href="graphs.html#adding-text-to-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes you might want to add some text to your plots. This is possible with <code>geom_text()</code>:</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="graphs.html#cb750-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb750-2"><a href="graphs.html#cb750-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb750-3"><a href="graphs.html#cb750-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(variable, value, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb750-4"><a href="graphs.html#cb750-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(variable, value <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">label =</span> value))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-447-1.png" width="672" /></p>
<p>You can put anything after <code>label =</code> but in general what you want are the values, so that’s what
I put there. But you can also refine it, imagine the values are actually in euros:</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="graphs.html#cb751-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb751-2"><a href="graphs.html#cb751-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb751-3"><a href="graphs.html#cb751-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(variable, value, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb751-4"><a href="graphs.html#cb751-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(variable, value <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(value, <span class="st">&quot;€&quot;</span>)))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-448-1.png" width="672" /></p>
<p>You can also achieve something similar with <code>geom_label()</code>:</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="graphs.html#cb752-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb752-2"><a href="graphs.html#cb752-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb752-3"><a href="graphs.html#cb752-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(variable, value, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb752-4"><a href="graphs.html#cb752-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(variable, value <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(value, <span class="st">&quot;€&quot;</span>)))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-449-1.png" width="672" /></p>
</div>
</div>
<div id="customization" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Customization<a href="graphs.html#customization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Every plot you’ve seen until now was made with the default look of <code>{ggplot2}</code>. If you want to change
the look, you can apply a theme, and a colour scheme. Let’s take a look at themes first by using the
ones found in the package <code>ggthemes</code>. But first, let’s learn how to change the names of the axes
and how to title a plot.</p>
<div id="changing-titles-axes-labels-options-mixing-geoms-and-changing-themes" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Changing titles, axes labels, options, mixing geoms and changing themes<a href="graphs.html#changing-titles-axes-labels-options-mixing-geoms-and-changing-themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The name of this subsection is quite long, but this is because everything is kind of linked. Let’s
start by learning what the <code>labs()</code> function does. To change the title of the plot, and of the axes,
you need to pass the names to the <code>labs()</code> function:</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="graphs.html#cb753-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb753-2"><a href="graphs.html#cb753-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb753-3"><a href="graphs.html#cb753-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb753-4"><a href="graphs.html#cb753-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb753-5"><a href="graphs.html#cb753-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-450-1.png" width="672" /></p>
<p>What if you want to make the lines thicker?</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="graphs.html#cb754-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb754-2"><a href="graphs.html#cb754-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb754-3"><a href="graphs.html#cb754-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb754-4"><a href="graphs.html#cb754-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb754-5"><a href="graphs.html#cb754-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-451-1.png" width="672" /></p>
<p>Each <code>geom_*()</code> function has its own options. Notice that the <code>size=2</code> argument is not inside
an <code>aes()</code> function. This is because I do not want to map a variable of the data to the size
of the line, in other words, I do not want to make the size of the line proportional to a certain
variable in the data. Recall the scatter plot we did earlier, where we showed that height and mass of
star wars characters increased together? Let’s take this plot again, but make the size of the dots proportional
to the birth year of the character:</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="graphs.html#cb755-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb755-2"><a href="graphs.html#cb755-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb755-3"><a href="graphs.html#cb755-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb755-4"><a href="graphs.html#cb755-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass, <span class="at">size =</span> birth_year))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-452-1.png" width="672" /></p>
<p>Making the size proportional to the birth year (the age would have been more informative) allows
us to see a third dimension. It is also possible to “see” a fourth dimension, the gender for instance,
by changing the colour of the dots:</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="graphs.html#cb756-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb756-2"><a href="graphs.html#cb756-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb756-3"><a href="graphs.html#cb756-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb756-4"><a href="graphs.html#cb756-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass, <span class="at">size =</span> birth_year, <span class="at">colour =</span> gender))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-453-1.png" width="672" /></p>
<p>As I promised above, we are now going to learn how to add a regression line to this scatter plot:</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="graphs.html#cb757-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb757-2"><a href="graphs.html#cb757-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb757-3"><a href="graphs.html#cb757-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb757-4"><a href="graphs.html#cb757-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass, <span class="at">size =</span> birth_year, <span class="at">colour =</span> gender)) <span class="sc">+</span></span>
<span id="cb757-5"><a href="graphs.html#cb757-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(height, mass), <span class="at">method  =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-454-1.png" width="672" /></p>
<p><code>geom_smooth()</code> adds a regression line, but only if you specify <code>method = "lm"</code> (“lm” stands for
“linear model”). What happens if you remove this option?</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="graphs.html#cb759-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb759-2"><a href="graphs.html#cb759-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb759-3"><a href="graphs.html#cb759-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb759-4"><a href="graphs.html#cb759-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass, <span class="at">size =</span> birth_year, <span class="at">colour =</span> gender)) <span class="sc">+</span></span>
<span id="cb759-5"><a href="graphs.html#cb759-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(height, mass))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-455-1.png" width="672" /></p>
<p>By default, <code>geom_smooth()</code> does a non-parametric regression called LOESS (locally estimated scatterplot smoothing),
which is more flexible. It is also possible to have one regression line by gender:</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="graphs.html#cb761-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb761-2"><a href="graphs.html#cb761-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(name, <span class="st">&quot;Jabba&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb761-3"><a href="graphs.html#cb761-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb761-4"><a href="graphs.html#cb761-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(height, mass, <span class="at">size =</span> birth_year, <span class="at">colour =</span> gender)) <span class="sc">+</span></span>
<span id="cb761-5"><a href="graphs.html#cb761-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(height, mass, <span class="at">colour =</span> gender))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="modern_R_files/figure-html/unnamed-chunk-456-1.png" width="672" /></p>
<p>Because there are only a few observations for feminines and <code>NA</code>s the regression lines are not very informative,
but this was only an example to show you some options of <code>geom_smooth()</code>.</p>
<p>Let’s go back to the unemployment line plots. For now, let’s keep the base <code>{ggplot2}</code> theme, but
modify it a bit. For example, the legend placement is actually a feature of the theme. This means
that if you want to change where the legend is placed you need to modify this feature from the
theme. This is done with the function <code>theme()</code>:</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="graphs.html#cb763-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb763-2"><a href="graphs.html#cb763-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb763-3"><a href="graphs.html#cb763-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb763-4"><a href="graphs.html#cb763-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb763-5"><a href="graphs.html#cb763-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb763-6"><a href="graphs.html#cb763-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-457-1.png" width="672" /></p>
<p>What I also like to do is remove the title of the legend, because it is often superfluous:</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="graphs.html#cb764-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb764-2"><a href="graphs.html#cb764-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb764-3"><a href="graphs.html#cb764-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb764-4"><a href="graphs.html#cb764-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb764-5"><a href="graphs.html#cb764-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb764-6"><a href="graphs.html#cb764-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-458-1.png" width="672" /></p>
<p>The legend title has to be an <code>element_text</code> object.<code>element_text</code> objects are used with <code>theme</code> to
specify how text should be displayed. <code>element_blank()</code> draws nothing and assigns no space (not
even blank space). If you want to keep the legend title but change it, you need to use <code>element_text()</code>:</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="graphs.html#cb765-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb765-2"><a href="graphs.html#cb765-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb765-3"><a href="graphs.html#cb765-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb765-4"><a href="graphs.html#cb765-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb765-5"><a href="graphs.html#cb765-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb765-6"><a href="graphs.html#cb765-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-459-1.png" width="672" /></p>
<p>If you want to change the word “division” to something else, you can do so by providing the <code>colour</code> argument
to the <code>labs()</code> function:</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="graphs.html#cb766-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb766-2"><a href="graphs.html#cb766-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb766-3"><a href="graphs.html#cb766-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb766-4"><a href="graphs.html#cb766-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb766-5"><a href="graphs.html#cb766-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;Administrative division&quot;</span>) <span class="sc">+</span></span>
<span id="cb766-6"><a href="graphs.html#cb766-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-460-1.png" width="672" /></p>
<p>You could modify every feature of the theme like that, but there are built-in themes that you can use:</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="graphs.html#cb767-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb767-2"><a href="graphs.html#cb767-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb767-3"><a href="graphs.html#cb767-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb767-4"><a href="graphs.html#cb767-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb767-5"><a href="graphs.html#cb767-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb767-6"><a href="graphs.html#cb767-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb767-7"><a href="graphs.html#cb767-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-461-1.png" width="672" /></p>
<p>For example in the code above, I have used <code>theme_minimal()</code> which I like quite a lot. You can also
use themes from the <code>ggthemes</code> package, which even contains a STATA theme, if you like it:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="graphs.html#cb768-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb768-2"><a href="graphs.html#cb768-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb768-3"><a href="graphs.html#cb768-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb768-4"><a href="graphs.html#cb768-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_stata</span>() <span class="sc">+</span></span>
<span id="cb768-5"><a href="graphs.html#cb768-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb768-6"><a href="graphs.html#cb768-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-462-1.png" width="672" /></p>
<p>As you can see, <code>theme_stata()</code> has the legend on the bottom by default, because this is how the
legend position is defined within the theme. However the legend title is still there. Let’s remove
it:</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="graphs.html#cb769-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb769-2"><a href="graphs.html#cb769-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb769-3"><a href="graphs.html#cb769-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb769-4"><a href="graphs.html#cb769-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_stata</span>() <span class="sc">+</span></span>
<span id="cb769-5"><a href="graphs.html#cb769-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb769-6"><a href="graphs.html#cb769-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb769-7"><a href="graphs.html#cb769-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-463-1.png" width="672" /></p>
<p><code>ggthemes</code> even features an Excel 2003 theme (don’t use it though):</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="graphs.html#cb770-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb770-2"><a href="graphs.html#cb770-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb770-3"><a href="graphs.html#cb770-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb770-4"><a href="graphs.html#cb770-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_excel</span>() <span class="sc">+</span></span>
<span id="cb770-5"><a href="graphs.html#cb770-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb770-6"><a href="graphs.html#cb770-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-464-1.png" width="672" /></p>
<p>You can create your own theme by using a simple theme, such as <code>theme_minimal()</code> as a base
and then add your options. We are going to create one theme after we learn how to create our
own functions, in Chapter 7. Then, we are going to create a package to share this theme with
the world, and we are going to learn how to make packages in Chapter 9.</p>
</div>
<div id="colour-schemes" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Colour schemes<a href="graphs.html#colour-schemes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also change colour schemes, by specifying either <code>scale_colour_*()</code> or <code>scale_fill_*()</code>
functions. <code>scale_colour_*()</code> functions are used for continuous variables, while <code>scale_fill_*()</code>
functions for discrete variables (so for barplots for example). A colour scheme I like is the
<a href="https://www.highcharts.com/">Highcharts</a> colour scheme.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="graphs.html#cb771-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb771-2"><a href="graphs.html#cb771-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb771-3"><a href="graphs.html#cb771-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb771-4"><a href="graphs.html#cb771-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb771-5"><a href="graphs.html#cb771-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_hc</span>() <span class="sc">+</span></span>
<span id="cb771-6"><a href="graphs.html#cb771-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb771-7"><a href="graphs.html#cb771-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb771-8"><a href="graphs.html#cb771-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-465-1.png" width="672" /></p>
<p>An example with a barplot:</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="graphs.html#cb772-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb772-2"><a href="graphs.html#cb772-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb772-3"><a href="graphs.html#cb772-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(variable, value, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb772-4"><a href="graphs.html#cb772-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(variable, value <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">label =</span> value)) <span class="sc">+</span></span>
<span id="cb772-5"><a href="graphs.html#cb772-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb772-6"><a href="graphs.html#cb772-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hc</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-466-1.png" width="672" /></p>
<p>It is also possible to define and use your own palette.</p>
<p>To use your own colours you can use <code>scale_colour_manual()</code> and <code>scale_fill_manual()</code> and specify
the html codes of the colours you want to use.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="graphs.html#cb773-1" aria-hidden="true" tabindex="-1"></a>unemp_lux_data <span class="sc">%&gt;%</span></span>
<span id="cb773-2"><a href="graphs.html#cb773-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(division <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Esch-sur-Alzette&quot;</span>, <span class="st">&quot;Wiltz&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb773-3"><a href="graphs.html#cb773-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, unemployment_rate_in_percent, <span class="at">group =</span> division, <span class="at">colour =</span> division)) <span class="sc">+</span></span>
<span id="cb773-4"><a href="graphs.html#cb773-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb773-5"><a href="graphs.html#cb773-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FF336C&quot;</span>, <span class="st">&quot;#334BFF&quot;</span>, <span class="st">&quot;#2CAE00&quot;</span>)) <span class="sc">+</span></span>
<span id="cb773-6"><a href="graphs.html#cb773-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb773-7"><a href="graphs.html#cb773-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Luxembourg, Esch/Alzette and Wiltz&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb773-8"><a href="graphs.html#cb773-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-467-1.png" width="672" /></p>
<p>To get html codes of colours you can use <a href="http://htmlcolorcodes.com/color-picker/">this online
tool</a>.
There is also a very nice package, called <code>colourpicker</code> that allows you to
pick colours from with RStudio. Also, you do not even need to load it to use
it, since it comes with an Addin:</p>
<p><img src="pics/rstudio_colourpicker.gif" /><!-- --></p>
<p>For a barplot you would do the same:</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="graphs.html#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data_long) <span class="sc">+</span></span>
<span id="cb774-2"><a href="graphs.html#cb774-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span></span>
<span id="cb774-3"><a href="graphs.html#cb774-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(variable, value, <span class="at">fill =</span> variable), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb774-4"><a href="graphs.html#cb774-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(variable, value <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">label =</span> value)) <span class="sc">+</span></span>
<span id="cb774-5"><a href="graphs.html#cb774-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb774-6"><a href="graphs.html#cb774-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb774-7"><a href="graphs.html#cb774-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FF336C&quot;</span>, <span class="st">&quot;#334BFF&quot;</span>, <span class="st">&quot;#2CAE00&quot;</span>, <span class="st">&quot;#B3C9C6&quot;</span>, <span class="st">&quot;#765234&quot;</span>))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-469-1.png" width="672" /></p>
<p>For countinuous variables, things are a bit different. Let’s first create a plot where we map a continuous
variable to the colour argument of <code>aes()</code>:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="graphs.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span></span>
<span id="cb775-2"><a href="graphs.html#cb775-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(carat, price, <span class="at">colour =</span> depth))</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-470-1.png" width="672" /></p>
<p>To change the colour, we need to use <code>scale_color_gradient()</code> and specify a value for low values of the variable,
and a value for high values of the variable. For example, using the colours of the theme I made for my blog:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="graphs.html#cb776-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span></span>
<span id="cb776-2"><a href="graphs.html#cb776-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(carat, price, <span class="at">colour =</span> depth)) <span class="sc">+</span></span>
<span id="cb776-3"><a href="graphs.html#cb776-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#bec3b8&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#ad2c6c&quot;</span>)</span></code></pre></div>
<p><img src="modern_R_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
</div>
</div>
<div id="saving-plots-to-disk" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Saving plots to disk<a href="graphs.html#saving-plots-to-disk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two ways to save plots on disk; one through the <em>Plots</em> plane in RStudio and another using the
<code>ggsave()</code> function. Using RStudio, navigate to the <em>Plots</em> pane and click on <em>Export</em>. You can
then choose where to save the plot and other various options:</p>
<p><img src="pics/rstudio_save_plots.gif" /><!-- --></p>
<p>This is fine if you only generate one or two plots but if you generate a large number of them, it
is less tedious to use the <code>ggsave()</code> function:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="graphs.html#cb777-1" aria-hidden="true" tabindex="-1"></a>my_plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_data) <span class="sc">+</span></span>
<span id="cb777-2"><a href="graphs.html#cb777-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(variable))</span>
<span id="cb777-3"><a href="graphs.html#cb777-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb777-4"><a href="graphs.html#cb777-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;path/you/want/to/save/the/plot/to/my_plot1.pdf&quot;</span>, my_plot1)</span></code></pre></div>
<p>There are other options that you can specify such as the width and height, resolution, units,
etc…</p>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Exercises<a href="graphs.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-1-3" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1<a href="graphs.html#exercise-1-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the <code>Bwages</code> dataset from the <code>Ecdat</code> package. Your first task is to create a new variable,
<code>educ_level</code>, which is a factor variable that equals:</p>
<ul>
<li>“Primary school” if <code>educ == 1</code></li>
<li>“High school” if <code>educ == 2</code></li>
<li>“Some university” if <code>educ == 3</code></li>
<li>“Master’s degree” if <code>educ == 4</code></li>
<li>“Doctoral degree” if <code>educ == 5</code></li>
</ul>
<p>Use <code>case_when()</code> for this.</p>
<p>Then, plot a scatter plot of wages on experience, by education level. Add a theme that you like,
and remove the title of the legend.</p>
<p>The scatter plot is not very useful, because you cannot make anything out. Instead, use another
geom that shows you a non-parametric fit with confidence bands.</p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-wilkinson2006" class="csl-entry">
Wilkinson, Leland. 2006. <em>The Grammar of Graphics</em>. Springer Science &amp; Business Media.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptive-statistics-and-data-manipulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
